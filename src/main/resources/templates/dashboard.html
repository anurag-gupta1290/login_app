
<!DOCTYPE html>
<html lang="en">
<head>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StudySmart Pro | AI Learning Platform</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #6366f1;
            --secondary: #8b5cf6;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --dark: #1e293b;
            --light: #f8fafc;
            --glass-bg: rgba(255, 255, 255, 0.1);
            --glass-border: rgba(255, 255, 255, 0.2);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: var(--dark);
            overflow-x: hidden;
        }

        /* Glassmorphism Effect */
        .glass {
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        /* Sidebar */
        .sidebar {
            width: 280px;
            background: rgba(30, 41, 59, 0.95);
            position: fixed;
            height: 100%;
            top: 0;
            left: 0;
            padding: 30px 0;
            z-index: 1000;
            transition: all 0.3s ease;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
            color: white;
            font-size: 1.5rem;
            font-weight: 700;
            padding: 0 25px 30px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .nav-links {
            padding: 20px 15px;
        }

        .nav-link {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px 20px;
            color: rgba(255, 255, 255, 0.8);
            text-decoration: none;
            border-radius: 12px;
            transition: all 0.3s ease;
            cursor: pointer;
            margin-bottom: 8px;
            position: relative;
            overflow: hidden;
        }

        .nav-link:hover, .nav-link.active {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            transform: translateX(5px);
        }

        .nav-link::after {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            width: 4px;
            background: var(--primary);
            transform: scaleY(0);
            transition: transform 0.3s ease;
        }

        .nav-link.active::after {
            transform: scaleY(1);
        }

        /* Main Content */
        .main-content {
            margin-left: 280px;
            padding: 30px;
            min-height: 100vh;
            transition: all 0.3s ease;
        }

        .section {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        /* Images */
        .course-img {
            width: 100%;           /* always full width */
            height: 180px;         /* fixed height for all */
            object-fit: cover;     /* crop karega, stretch nahi karega */
            object-position: center; /* image center se crop hogi */
            border-top-left-radius: 10px;
            border-top-right-radius: 10px;
        }

        /* Cards */
        .card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            border: none;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            margin-bottom: 25px;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            overflow: hidden;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
        }

        /* Buttons */
        .btn-custom {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border: none;
            border-radius: 10px;
            padding: 12px 25px;
            color: white;
            font-weight: 600;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .btn-custom:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(99, 102, 241, 0.4);
        }

        .btn-custom::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: all 0.5s ease;
        }

        .btn-custom:hover::before {
            left: 100%;
        }

        /* Stats */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            text-align: center;
            padding: 25px;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 5px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }

        .stat-card:hover::before {
            transform: scaleX(1);
        }

        .stat-icon {
            width: 60px;
            height: 60px;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
            margin: 0 auto 15px;
            transition: transform 0.3s ease;
        }

        .stat-card:hover .stat-icon {
            transform: scale(1.1);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 5px;
        }

        /* Progress */
        .progress {
            height: 8px;
            background: #e2e8f0;
            border-radius: 10px;
            margin: 10px 0;
            overflow: hidden;
        }

        .progress-bar {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 10px;
            position: relative;
            overflow: hidden;
        }

        .progress-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            bottom: 0;
            right: 0;
            background-image: linear-gradient(
                    -45deg,
                    rgba(255, 255, 255, 0.2) 25%,
                    transparent 25%,
                    transparent 50%,
                    rgba(255, 255, 255, 0.2) 50%,
                    rgba(255, 255, 255, 0.2) 75%,
                    transparent 75%,
                    transparent
            );
            z-index: 1;
            background-size: 50px 50px;
            animation: move 2s linear infinite;
            border-radius: 10px;
        }

        @keyframes move {
            0% {
                background-position: 0 0;
            }
            100% {
                background-position: 50px 50px;
            }
        }
        /* ===== ASSIGNMENT SECTION STYLING ===== */

        /* Container Setup */
        #assignment-list-container {
            display: grid;
            gap: 15px;
            padding: 10px;
            max-height: 500px; /* Scrollable if many tasks */
            overflow-y: auto;
        }

        /* Individual Assignment Card */
        .assignment-item {
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(0, 0, 0, 0.05);
            border-radius: 20px;
            padding: 20px !important;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.02);
            margin-bottom: 10px;
        }

        .assignment-item:hover {
            transform: translateY(-5px) scale(1.01);
            background: #ffffff;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.1);
            border-color: #00d2ff;
        }

        /* Typography */
        .assignment-item h5 {
            color: #2d3436;
            font-size: 1.1rem;
            margin-bottom: 5px;
            letter-spacing: -0.2px;
        }

        .assignment-item p {
            color: #636e72;
            font-size: 0.9rem;
            line-height: 1.4;
        }

        /* Status Badges */
        .text-success, .text-danger {
            font-weight: 600;
            font-size: 0.8rem;
            display: inline-flex;
            align-items: center;
            gap: 5px;
            padding: 4px 12px;
            border-radius: 50px;
        }

        .text-success {
            background: rgba(46, 213, 115, 0.15);
            color: #218c74 !important;
        }

        .text-danger {
            background: rgba(255, 71, 87, 0.15);
            color: #eb4d4b !important;
        }

        /* Buttons Styling */
        .assignment-item .btn {
            font-weight: 500;
            letter-spacing: 0.3px;
            padding: 8px 18px !important;
            transition: 0.2s;
            border: none;
        }

        .btn-success {
            background: linear-gradient(135deg, #2ecc71, #27ae60);
            box-shadow: 0 4px 12px rgba(46, 204, 113, 0.2);
        }

        .btn-outline-primary {
            border: 1.5px solid #3a7bd5 !important;
            color: #3a7bd5 !important;
            background: transparent;
        }

        .btn-outline-primary:hover {
            background: #3a7bd5 !important;
            color: #fff !important;
        }

        .btn-outline-secondary {
            border: 1.5px solid #636e72 !important;
            color: #636e72 !important;
        }

        /* Custom Scrollbar */
        #assignment-list-container::-webkit-scrollbar {
            width: 6px;
        }

        #assignment-list-container::-webkit-scrollbar-track {
            background: transparent;
        }

        #assignment-list-container::-webkit-scrollbar-thumb {
            background: rgba(0, 0, 0, 0.1);
            border-radius: 10px;
        }

        /* Modal Enhancements */
        .modal-content {
            border: none;
            box-shadow: 0 25px 50px rgba(0,0,0,0.2);
            overflow: hidden;
        }

        .modal-header {
            border-bottom: 1px solid rgba(0,0,0,0.05);
        }

        .form-control {
            background: #f8f9fa;
            border: 2px solid transparent;
            padding: 12px 20px;
            transition: 0.3s;
        }

        .form-control:focus {
            background: #fff;
            border-color: #00d2ff;
            box-shadow: 0 0 0 4px rgba(0, 210, 255, 0.1);
        }
        /* Course Cards */
        /* Course Grid Container â€“ all cards equal height */
        /* Video Wrapper ko Card ke upar "Full Width" dikhane ke liye */
        .video-overlay-container {
            display: none; /* JS se show hoga */
            position: fixed; /* Screen par fix rahega */
            top: 50%;
            left: calc(50% + 125px); /* Sidebar width (250px approx) ka half adjust kiya */
            transform: translate(-50%, -50%);
            width: 80%; /* Screen ka 80% area */
            max-width: 1000px;
            z-index: 9999;
            background: #1e293b;
            padding: 20px;
            border-radius: 20px;
            box-shadow: 0 0 100px rgba(0,0,0,0.8);
        }

        /* Background ko thoda dhundhla (blur) karne ke liye */
        .video-backdrop {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            backdrop-filter: blur(5px);
            z-index: 9998;
        }

        /* Video Tag ki styling */
        .full-width-video {
            width: 100% !important;
            height: auto;
            border-radius: 12px;
            display: block;
        }
        .course-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(330px, 1fr));
            gap: 25px;
            align-items: stretch; /* cards equal height */
        }

        /* Course Cards */
        .course-card {
            display: flex;
            flex-direction: column;
            background: white;
            border-radius: 20px;
            overflow: hidden;

            height: 520px;        /* ðŸ”¥ all cards equal */
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transition: transform 0.2s ease;
        }

        .course-card:hover {
            transform: translateY(-5px);
        }

        /* Top Banner Image */
        .course-card img {
            width: 100%;
            height: 200px;
            object-fit: cover;
        }

        /* If a card uses a colored header instead of an image */
        .course-header {
            /* Same height as image */
            height: auto;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            position: relative;
            width: 100%;
        }

        /* Category Badge */
        .course-category {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(255, 255, 255, 0.95);
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            color: var(--primary);
        }
        /* Recommended course cards override */
        .course-card.recommended {
            height: auto;      /* ðŸ”¥ FIX */
            min-height: 260px;
            padding: 30px 20px;
            align-items: center;
        }


        /* Content Section */
        .course-content {
            padding: 25px;
            flex: 1;                      /* make content grow equally */
            display: flex;
            flex-direction: column;
        }

        /* Title */
        .course-content h3 {
            font-size: 1.2rem;
            font-weight: 700;
            margin-bottom: 8px;
        }

        /* Subtitle */
        .course-content p {
            font-size: 0.9rem;
            color: #555;
        }

        /* Progress Bar Area */
        .course-progress {
            margin-top: auto;            /* keep at bottom */
        }

        /* Buttons row */
        .course-actions {
            display: flex;
            justify-content: space-between;
            margin-top: 15px;
        }


        /* Notification */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            border-radius: 10px;
            font-weight: 600;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            z-index: 10000;
            opacity: 0;
            transform: translateX(100px);
            transition: all 0.3s ease;
        }

        .notification.show {
            opacity: 1;
            transform: translateX(0);
        }

        /* Header */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding: 15px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .user-profile {
            display: flex;
            align-items: center;
            gap: 15px;
            color: white;
        }

        .profile-img {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 1.2rem;
        }

        /* AI Chat */
        .ai-chat-container {
            height: 300px;
            overflow-y: auto;
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
        }

        .ai-message {
            margin-bottom: 15px;
            padding: 10px 15px;
            border-radius: 10px;
            max-width: 80%;
        }

        .bot-message {
            background: #e3f2fd;
            align-self: flex-start;
        }

        .user-message {
            background: #f0f4ff;
            align-self: flex-end;
            margin-left: auto;
        }

        /* Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background: white;
            border-radius: 15px;
            padding: 30px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            transform: scale(0.7);
            transition: transform 0.3s ease;
        }

        .modal-overlay.active .modal-content {
            transform: scale(1);
        }
        /* Leaderboard Modern Design */

        .leader-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 15px;
            margin-bottom: 8px;
            border-radius: 10px;
            transition: transform 0.2s ease;
            /* Light mode defaults */
            background: rgba(0, 0, 0, 0.04);
            border: 1px solid rgba(0, 0, 0, 0.05);
        }
        /* --- LEADERBOARD THEME FIX --- */
        :root {
            --lb-bg: #ffffff;
            --lb-text: #1e293b;
            --lb-border: #e2e8f0;
        }

        /* Agar aap dark mode ke liye 'dark' class use karte hain */
        body.dark-mode, [data-theme="dark"] {
            --lb-bg: #1e293b;   /* Dark background */
            --lb-text: #f8fafc; /* White text */
            --lb-border: #334155;
        }

        .custom-leader-item {
            background-color: var(--lb-bg) !important;
            color: var(--lb-text) !important;
            border: 1px solid var(--lb-border) !important;
            border-radius: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 15px;
            margin-bottom: 8px;
            transition: all 0.3s ease;
        }

        .custom-leader-item.is-me {
            background-color: rgba(99, 102, 241, 0.15) !important;
            border: 1px solid #6366f1 !important;
        }
        /* Dark Mode Adaptation */
        [data-theme="dark"] .leader-item,
        body.dark-mode .leader-item {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .leader-item:hover {
            transform: scale(1.02);
        }

        /* "You" special styling */
        .leader-item.is-me {
            border-left: 4px solid #6366f1 !important;
            background: rgba(99, 102, 241, 0.1) !important;
        }

        .leader-name {
            font-weight: 500;
            color: var(--text-color, #1e293b); /* Fallback to dark if var not set */
        }

        [data-theme="dark"] .leader-name,
        body.dark-mode .leader-name {
            color: #f8fafc;
        }

        .rank-number {
            color: #94a3b8;
            font-size: 0.9rem;
            width: 25px;
            display: inline-block;
        }

        .progress-label {
            font-weight: 700;
            color: #10b981; /* Green color stays same for both */
            background: rgba(16, 185, 129, 0.1);
            padding: 2px 8px;
            border-radius: 6px;
        }

        /* Responsive */
        @media (max-width: 992px) {
            .sidebar {
                width: 80px;
            }

            .sidebar .logo span,
            .sidebar .nav-link span {
                display: none;
            }

            .main-content {
                margin-left: 80px;
            }

            .logo {
                justify-content: center;
                padding: 0 10px 30px;
            }
        }

        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
            }

            .sidebar.active {
                transform: translateX(0);
            }

            .main-content {
                margin-left: 0;
            }

            .menu-toggle {
                display: block;
            }
        }

        /* Menu Toggle */
        .menu-toggle {
            display: none;
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 1001;
        }

        /* Floating Action Button */
        .fab {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            cursor: pointer;
            z-index: 999;
            transition: all 0.3s ease;
        }

        .fab:hover {
            transform: scale(1.1);
        }

        /* Loading Animation */
        .loader {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Achievement Badges */
        .badge {
            transition: transform 0.3s ease;
        }

        .badge:hover {
            transform: scale(1.1);
        }

        /* Study Timer */
        .timer-container {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .timer-display {
            font-size: 3rem;
            font-weight: bold;
            text-align: center;
            color: white;
            margin: 20px 0;
        }

        /* Study Session */
        .study-session {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 25px;
            margin-top: 20px;
        }

        /* NEW STYLES FOR ENHANCED FEATURES */

        /* Pomodoro Timer */
        .pomodoro-container {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .pomodoro-options {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 15px;
        }

        .pomodoro-btn {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            border-radius: 8px;
            padding: 8px 15px;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .pomodoro-btn.active {
            background: var(--primary);
        }

        /* Flash Cards */
        /* Card Container */
        .flashcard-inner {
            width: 100%;
            height: 250px;
            position: relative;
            transition: transform 0.6s;
            transform-style: preserve-3d;
            cursor: pointer;
        }

        /* Jab is-flipped class add hogi, tab card ghumega */
        .flashcard-inner.is-flipped {
            transform: rotateY(180deg);
        }

        /* Front aur Back side ki common styling */
        .card-front, .card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden; /* Peeche ka hissa chhupane ke liye */
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
        }

        /* Peeche ka side (shuruat mein 180 deg ghuma hua) */
        .card-back {
            background-color: #f8f9fa;
            color: #333;
            transform: rotateY(180deg);
        }

        .card-front {
            background-color: #7c4dff;
            color: white;
        }
        .flashcard {
            height: 200px;
            perspective: 1000px;
            cursor: pointer;
            margin-bottom: 20px;
        }

        .flashcard-inner {
            position: relative;
            width: 100%;
            height: 100%;
            text-align: center;
            transition: transform 0.6s;
            transform-style: preserve-3d;
        }

        .flashcard.flipped .flashcard-inner {
            transform: rotateY(180deg);
        }

        .flashcard-front, .flashcard-back {
            position: absolute;
            width: 100%;
            height: 100%;
            -webkit-backface-visibility: hidden;
            backface-visibility: hidden;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .flashcard-front {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
        }

        .flashcard-back {
            background: white;
            color: var(--dark);
            transform: rotateY(180deg);
        }
        /* Video wrapper styling */
        .video-wrapper {
            display: none;
            margin-top: 15px;
            background: rgba(0,0,0,0.9);
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        .video-wrapper video {
            border-radius: 8px;
            max-height: 400px;
        }

        .video-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .video-header h6 {
            color: white;
            margin: 0;
        }
        /* Study Groups */
        .study-group-card {
            padding: 20px;
            border-left: 5px solid var(--primary);
        }

        .group-members {
            display: flex;
            margin-top: 15px;
        }

        .member {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            background: var(--primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: -10px;
            border: 2px solid white;
            font-size: 0.8rem;
        }

        /* Study Goals */
        .goal-progress {
            display: flex;
            align-items: center;
            margin-top: 10px;
        }

        .goal-check {
            width: 25px;
            height: 25px;
            border-radius: 50%;
            border: 2px solid var(--primary);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 10px;
            cursor: pointer;
        }

        .goal-check.completed {
            background: var(--success);
            border-color: var(--success);
            color: white;
        }

        /* Notes Section */
        .notes-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
        }

        .note-card {
            padding: 15px;
            border-radius: 10px;
            background: white;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
            position: relative;
            transition: transform 0.3s ease;
        }

        .note-card:hover {
            transform: translateY(-5px);
        }

        .note-actions {
            position: absolute;
            top: 10px;
            right: 10px;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .note-card:hover .note-actions {
            opacity: 1;
        }

        /* Calendar */
        /* --- THEME INDEPENDENT CALENDAR --- */
        /* Ye CSS hona zaroori hai tabhi grid banegi */
        /* Purana hatakar ye wala copy karein */
        #calendarGrid {
            display: grid !important;
            grid-template-columns: repeat(7, 1fr) !important;
            gap: 8px;
            padding: 15px;
            background: var(--cal-bg);
            border-radius: 12px;
            min-height: 300px;
        }

        .calendar-day {
            aspect-ratio: 1; /* Din ko barabar square banata hai */
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            border-radius: 10px;
            font-size: 0.95rem;
            transition: all 0.2s;
            position: relative;
            color: var(--cal-text);
        }

        .calendar-day:hover:not(.empty):not(.fw-bold) {
            background-color: var(--cal-hover);
            transform: scale(1.1);
        }

        .calendar-day.active {
            background: #6366f1 !important;
            color: white !important;
            font-weight: bold;
            box-shadow: 0 4px 10px rgba(99, 102, 241, 0.4);
        }

        .calendar-day.has-event::after {
            content: '';
            width: 6px;
            height: 6px;
            background: #ef4444; /* Red Dot */
            border-radius: 50%;
            position: absolute;
            bottom: 4px;
        }
        .calendar-day:hover {
            background: #f0f0f0;
        }

        .calendar-day.active {
            background: var(--primary) !important;
            color: white !important;
            font-weight: bold;
        }

        .calendar-day.has-event {
            position: relative;
            color: var(--primary);
            font-weight: bold;
        }

        .calendar-day.has-event::after {
            content: '';
            position: absolute;
            bottom: 5px;
            width: 4px;
            height: 4px;
            background: var(--danger);
            border-radius: 50%;
        }
        :root {
            --cal-bg: #ffffff;
            --cal-text: #1e293b;
            --cal-border: #e2e8f0;
            --cal-hover: rgba(99, 102, 241, 0.1);
        }

        /* Dark Mode Detect (Body class check) */
        body.dark-mode, [data-theme="dark"] {
            --cal-bg: #1e293b;   /* Dark Slate */
            --cal-text: #f8fafc; /* Off White */
            --cal-border: #334155;
            --cal-hover: rgba(255, 255, 255, 0.05);
        }

        .calendar {
            background-color: var(--cal-bg) !important;
            color: var(--cal-text) !important;
            border: 1px solid var(--cal-border);
            border-radius: 15px;
            padding: 20px;
            transition: all 0.3s ease;
        }

        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 5px;
        }

        .calendar-day {
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            position: relative;
            cursor: pointer;
            font-size: 0.9rem;
            color: var(--cal-text) !important; /* Force text color */
        }

        /* Header (Sun, Mon...) colors */
        .calendar-day.fw-bold {
            color: #6366f1 !important; /* Theme Purple */
        }

        .calendar-day:hover:not(.active) {
            background-color: var(--cal-hover);
        }

        .calendar-day.active {
            background: #6366f1 !important;
            color: white !important; /* Blue background pe white text hamesha */
            font-weight: bold;
        }

        .calendar-day.has-event::after {
            content: '';
            width: 6px;
            height: 6px;
            background: #ef4444; /* Red dot */
            border-radius: 50%;
            position: absolute;
            bottom: 5px;
        }
        /* Leaderboard */
        .leaderboard-item {
            display: flex;
            align-items: center;
            padding: 10px 15px;
            border-radius: 10px;
            margin-bottom: 10px;
            background: rgba(255, 255, 255, 0.9);
        }

        .leaderboard-rank {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: var(--primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            font-weight: bold;
        }

        /* Dark theme styles */
        body.dark-theme {
            background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
            color: #f8fafc;
        }

        body.dark-theme .card {
            background: rgba(30, 41, 59, 0.9);
            color: #f8fafc;
        }

        body.dark-theme .text-muted {
            color: #cbd5e1 !important;
        }

        body.dark-theme .btn-outline-primary {
            color: #cbd5e1;
            border-color: #cbd5e1;
        }

        body.dark-theme .btn-outline-primary:hover {
            background-color: #6366f1;
            border-color: #6366f1;
        }

        body.dark-theme .modal-content {
            background: #1e293b;
            color: #f8fafc;
        }

        body.dark-theme .ai-chat-container {
            background: #334155;
        }

        body.dark-theme .bot-message {
            background: #475569;
            color: #f8fafc;
        }

        body.dark-theme .user-message {
            background: #6366f1;
            color: white;
        }

        body.dark-theme .note-card {
            background: #334155;
            color: #f8fafc;
        }

        body.dark-theme .flashcard-back {
            background: #334155;
            color: #f8fafc;
        }
    </style>
</head>
<body>

<!-- Menu Toggle for Mobile -->
<button class="menu-toggle" id="menuToggle">
    <i class="fas fa-bars"></i>
</button>

<!-- Sidebar Navigation -->
<div class="sidebar" id="sidebar">
    <div class="logo">
        <i class="fas fa-graduation-cap"></i>
        <span>StudySmart Pro</span>
    </div>

    <div class="nav-links">
        <div class="nav-link active" onclick="showSection('dashboard')">
            <i class="fas fa-home"></i>
            <span>Dashboard</span>
        </div>
        <div class="nav-link" onclick="showSection('courses')">
            <i class="fas fa-book-open"></i>
            <span>Smart Courses</span>
        </div>
        <div class="nav-link" onclick="showSection('assignments')">
            <i class="fas fa-tasks"></i>
            <span>Assignments</span>
        </div>
        <div class="nav-link" onclick="showSection('progress')">
            <i class="fas fa-chart-line"></i>
            <span>Progress</span>
        </div>
        <div class="nav-link" onclick="showSection('resources')">
            <i class="fas fa-file-alt"></i>
            <span>Resources</span>
        </div>
        <div class="nav-link" onclick="showSection('ai-tutor')">
            <i class="fas fa-robot"></i>
            <span>AI Tutor</span>
        </div>
        <!-- NEW NAVIGATION ITEMS -->
        <div class="nav-link" onclick="showSection('pomodoro')">
            <i class="fas fa-clock"></i>
            <span>Focus Timer</span>
        </div>
        <div class="nav-link" onclick="showSection('flashcards')">
            <i class="fas fa-layer-group"></i>
            <span>Flash Cards</span>
        </div>
        <div class="nav-link" onclick="showSection('notes')">
            <i class="fas fa-sticky-note"></i>
            <span>Notes</span>
        </div>
        <div class="nav-link" onclick="showSection('calendar')">
            <i class="fas fa-calendar-alt"></i>
            <span>Calendar</span>
        </div>
    </div>
</div>

<!-- Main Content -->
<div class="main-content" id="mainContent">
    <!-- Dashboard Section -->
    <div id="dashboard" class="section active">
        <div class="header">
            <div>
                <h1 class="text-white">Welcome back, <span class="text-warning">Anurag Gupta Website!</span> ðŸŽ“</h1>
                <p class="text-white-50">Your personalized learning journey continues...</p>
            </div>
            <div class="user-profile">
                <div class="profile-img">A</div>
                <div>
                    <div class="fw-bold user-name">Loading...</div> <!-- username span -->
                    <small class="text-white-50">Premium Member</small>
                </div>
            </div>

        </div>

        <!-- Stats Grid -->
        <div class="stats-grid">
            <div class="card stat-card" onclick="showSection('courses')">
                <div class="stat-icon" style="background: linear-gradient(135deg, #10b981, #059669);">
                    <i class="fas fa-book-open"></i>
                </div>
                <div class="stat-value">8</div>
                <div class="stat-label">Active Courses</div>
            </div>

            <div class="card stat-card" onclick="showSection('progress')">
                <div class="stat-icon" style="background: linear-gradient(135deg, #f59e0b, #d97706);">
                    <i class="fas fa-chart-line"></i>
                </div>
                <div id="overall-progress-dashboard" class="stat-value">0%</div>
                <div class="stat-label">Overall Progress</div>
            </div>

            <div class="card stat-card" onclick="showStudyAnalytics()">
                <div class="stat-icon" style="background: linear-gradient(135deg, #ef4444, #dc2626);">
                    <i class="fas fa-clock"></i>
                </div>
                <div class="stat-value">18.5h</div>
                <div class="stat-label">Study Time</div>
            </div>

            <div class="card stat-card" onclick="showSection('ai-tutor')">
                <div class="stat-icon" style="background: linear-gradient(135deg, #8b5cf6, #7c3aed);">
                    <i class="fas fa-robot"></i>
                </div>
                <div class="stat-value">24/7</div>
                <div class="stat-label">AI Tutor Available</div>
            </div>
        </div>

        <!-- Study Timer -->
        <div class="timer-container glass">
            <h5 class="text-white"><i class="fas fa-stopwatch"></i> Focus Timer</h5>
            <div class="timer-display" id="timerDisplay">25:00</div>
            <div class="d-flex justify-content-center gap-3">
                <button class="btn btn-success" onclick="startTimer()">
                    <i class="fas fa-play"></i> Start
                </button>
                <button class="btn btn-danger" onclick="stopTimer()">
                    <i class="fas fa-stop"></i> Stop
                </button>
                <button class="btn btn-warning" onclick="resetTimer()">
                    <i class="fas fa-redo"></i> Reset
                </button>
            </div>
        </div>

        <!-- Quick Actions -->
        <div class="card">
            <div class="card-body">
                <h5 class="card-title"><i class="fas fa-bolt text-warning"></i> Quick Actions</h5>
                <div class="d-flex gap-3 mt-3 flex-wrap">
                    <button class="btn btn-custom" onclick="startStudySession()">
                        <i class="fas fa-play"></i> Start Study Session
                    </button>
                    <button class="btn btn-outline-primary" onclick="showSection('assignments')">
                        <i class="fas fa-tasks"></i> View Assignments
                    </button>
                    <button class="btn btn-outline-primary" onclick="showSection('resources')">
                        <i class="fas fa-download"></i> Download Resources
                    </button>
                    <button class="btn btn-outline-primary" onclick="showSection('ai-tutor')">
                        <i class="fas fa-robot"></i> Ask AI Tutor
                    </button>
                </div>
            </div>
        </div>

        <!-- Today's Schedule -->
        <div class="row mt-4">
            <div class="col-md-6">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title"><i class="fas fa-calendar-day text-primary"></i> Today's Schedule</h5>
                        <div class="mt-3">
                            <div class="d-flex justify-content-between align-items-center mb-3">
                                <div>
                                    <h6 class="mb-1">Web Development</h6>
                                    <small class="text-muted">2:00 PM - 3:30 PM</small>
                                </div>
                                <button class="btn btn-success btn-sm" onclick="startClassSession('Web Development')">
                                    <i class="fas fa-play"></i> Start
                                </button>
                            </div>
                            <div class="d-flex justify-content-between align-items-center mb-3">
                                <div>
                                    <h6 class="mb-1">Machine Learning</h6>
                                    <small class="text-muted">4:00 PM - 5:00 PM</small>
                                </div>
                                <button class="btn btn-success btn-sm" onclick="startClassSession('Machine Learning')">
                                    <i class="fas fa-play"></i> Start
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-md-6">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title"><i class="fas fa-trophy text-warning"></i> Recent Achievements</h5>
                        <div class="mt-3">
                            <div class="alert alert-success">
                                <i class="fas fa-award"></i> <strong>Course Master!</strong> Completed Web Dev Module 3
                            </div>
                            <div class="alert alert-info">
                                <i class="fas fa-fire"></i> <strong>7-Day Streak!</strong> Keep up the great work
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- NEW: Study Goals -->
        <div class="card mt-4">
            <div class="card-body">
                <h5 class="card-title"><i class="fas fa-bullseye text-danger"></i> Study Goals</h5>
                <div class="mt-3">
                    <div class="goal-progress">
                        <div class="goal-check" onclick="toggleGoal(this)"><i class="fas fa-check"></i></div>
                        <div>Complete Web Development Module 4</div>
                    </div>
                    <div class="goal-progress">
                        <div class="goal-check completed" onclick="toggleGoal(this)"><i class="fas fa-check"></i></div>
                        <div>Finish Machine Learning Assignment</div>
                    </div>
                    <div class="goal-progress">
                        <div class="goal-check" onclick="toggleGoal(this)"><i class="fas fa-check"></i></div>
                        <div>Study for 2 hours daily</div>
                    </div>
                    <div class="goal-progress">
                        <div class="goal-check" onclick="toggleGoal(this)"><i class="fas fa-check"></i></div>
                        <div>Complete 5 practice problems</div>
                    </div>
                </div>
                <button class="btn btn-outline-primary btn-sm mt-3" onclick="addNewGoal()">
                    <i class="fas fa-plus"></i> Add New Goal
                </button>
            </div>
        </div>
    </div>

    <!-- Smart Courses Section -->
    <div id="courses" class="section">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h1 class="text-white">
                <i class="fas fa-book-open"></i> Smart Courses
            </h1>

            <div class="d-flex align-items-center">
                <!-- SEARCH INPUT (IMPORTANT) -->
                <input
                        type="text"
                        id="searchInput"
                        class="form-control me-2"
                        style="width: 220px;"
                        placeholder="Search course..."
                >

                <!-- FIND BUTTON -->
                <button class="btn btn-custom" onclick="findCourses()">
                    <i class="fas fa-search"></i> Find Courses
                </button>
            </div>
        </div>


        <div class="row">

            <!-- Course 1 -->
            <div class="col-md-4 mb-4">
                <div class="card course-card">

                    <!-- SAME HEADER ADDED (like others) -->
                    <div class="course-header" style="background: linear-gradient(135deg, #6366f1, #4338ca);">
                        <div class="course-category">Web Dev</div>
                    </div>

                    <!-- Image -->
                    <img src="/images/fullStack.png"
                         alt="Full Stack Web Development"
                         class="course-img">

                    <div class="course-content">
                        <h5 class="course-title">Full Stack Web Development</h5>

                        <p class="text-muted">Master HTML, CSS, JavaScript, React, Node.js, MongoDB</p>

                        <div class="progress">
                            <div class="progress-bar" style="width: 65%"></div>
                        </div>

                        <div class="d-flex justify-content-between mt-2">
                            <small>65% Complete</small>
                            <small>12/18 Modules</small>
                        </div>

                        <div class="d-flex gap-2 mt-3">
                            <button class="btn btn-custom btn-sm" onclick="continueCourse('Full Stack Web Development',1)">
                                <i class="fas fa-play"></i> Continue
                            </button>
                            <button class="btn btn-outline-secondary btn-sm" onclick="showCourseDetails('Full Stack Web Development',this)">
                                <i class="fas fa-info"></i> Details
                            </button>
                        </div>

                        <!-- NEW: Video Wrapper -->
                        <div id="commonVideoWrapper1" style="display:none; margin-top:15px;">
                            <h6 class="text-white">Now Playing</h6>
                            <video id="courseVideo1" width="100%" controls>
                                <source id="videoSource1" src="" type="video/mp4">
                                Your browser does not support the video tag.
                            </video>
                            <button onclick="closeVideo(1)" class="btn btn-sm btn-danger mt-2">Close Video</button>
                        </div>

                    </div>
                </div>
            </div>


            <!-- Course 2 -->
            <div class="col-md-4 mb-4">
                <div class="card course-card">
                    <div class="course-header" style="background: linear-gradient(135deg, #10b981, #059669);">
                        <div class="course-category">Data Science</div>
                    </div>

                    <!-- Image -->
                    <img src="/images/machineLearning.png"
                         alt="Machine Learning & AI"
                         class="course-img">

                    <div class="course-content">
                        <h5>Machine Learning & AI</h5>
                        <p class="text-muted">Python, TensorFlow, Neural Networks, Data Analysis</p>

                        <div class="progress">
                            <div class="progress-bar" style="width: 42%"></div>
                        </div>

                        <div class="d-flex justify-content-between mt-2">
                            <small>42% Complete</small>
                            <small>8/19 Modules</small>
                        </div>

                        <div class="d-flex gap-2 mt-3">
                            <button class="btn btn-custom btn-sm" onclick="continueCourse('Machine Learning & AI',2)">
                                <i class="fas fa-play"></i> Continue
                            </button>
                            <button class="btn btn-outline-secondary btn-sm" onclick="showCourseDetails('Machine Learning & AI',this)">
                                <i class="fas fa-info"></i> Details
                            </button>


                        </div>

                        <!-- NEW: Video Wrapper -->
                        <div id="commonVideoWrapper2" style="display:none; margin-top:15px;">
                            <h6 class="text-white">Now Playing</h6>
                            <video id="courseVideo2" width="100%" controls>
                                <source id="videoSource2" src="" type="video/mp4">
                                Your browser does not support the video tag.
                            </video>
                            <button onclick="closeVideo(2)" class="btn btn-sm btn-danger mt-2">Close Video</button>
                        </div>

                    </div>
                </div>
            </div>

            <!-- Course 3 -->
            <div class="col-md-4 mb-4">
                <div class="card course-card">
                    <div class="course-header" style="background: linear-gradient(135deg, #8b5cf6, #7c3aed);">
                        <div class="course-category">Mobile</div>
                    </div>

                    <!-- Image -->
                    <img src="/images/flutter.png"
                         alt="Flutter App Development"
                         class="course-img">

                    <div class="course-content">
                        <h5>Flutter App Development</h5>
                        <p class="text-muted">Build cross-platform iOS & Android apps with Dart</p>

                        <div class="progress">
                            <div class="progress-bar" style="width: 78%"></div>
                        </div>

                        <div class="d-flex justify-content-between mt-2">
                            <small>78% Complete</small>
                            <small>14/18 Modules</small>
                        </div>

                        <div class="d-flex gap-2 mt-3">
                            <button class="btn btn-custom btn-sm" onclick="continueCourse('Flutter App Development',3)">
                                <i class="fas fa-play"></i> Continue
                            </button>
                            <button class="btn btn-outline-secondary btn-sm" onclick="showCourseDetails('Flutter App Development',this)">
                                <i class="fas fa-info"></i> Details
                            </button>
                        </div>

                        <!-- NEW: Video Wrapper -->
                        <div id="commonVideoWrapper3" style="display:none; margin-top:15px;">
                            <h6 class="text-white">Now Playing</h6>
                            <video id="courseVideo3" width="100%" controls>
                                <source id="videoSource3" src="" type="video/mp4">
                                Your browser does not support the video tag.
                            </video>
                            <button onclick="closeVideo(3)" class="btn btn-sm btn-danger mt-2">Close Video</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Modal Section (Single Copy) -->
        <div id="courseDetailsModal1" class="modal-overlay" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.7); justify-content:center; align-items:center;">
            <div class="modal-content1" style="background:#fff; padding:20px; border-radius:10px; max-width:700px; width:90%;">
                <h3 id="courseModalTitle1"></h3>
                <div id="courseModalContent1" style="margin:10px 0;"></div>

                <button class="btn btn-custom w-100 mt-3" onclick="closeModal('courseDetailsModal')">Close</button>
            </div>
        </div>



        <!-- Recommended Courses -->
        <h4 class="text-white mt-4 mb-3">Recommended Courses</h4>
        <div class="row">
            <!-- Course 1: Database Design -->
            <div class="col-md-3 mb-3">
                <div class="course-card recommended">
                    <div class="card-body text-center">
                        <i class="fas fa-database fa-2x text-primary mb-3"></i>
                        <h6 class="course-title">Database Design</h6>

                        <!-- Enroll Button (Initially visible) -->
                        <button class="btn btn-outline-primary btn-sm mt-2 enroll-btn"
                                onclick="enrollCourse('Database Design', this, 4)">
                            <i class="fas fa-plus-circle"></i> Enroll Now
                        </button>

                        <!-- Continue Button (Initially hidden) -->
                        <button class="btn btn-custom btn-sm mt-2 continue-btn"
                                onclick="continueCourse('Database Design', 4)"
                                style="display: none;">
                            <i class="fas fa-play"></i> Continue
                        </button>

                        <!-- Success Message (Hidden initially) -->
                        <div class="alert alert-success success-msg mt-2 mb-0" style="display: none; padding: 8px 12px;">
                            <i class="fas fa-check-circle"></i> Enrolled Successfully!
                        </div>
                    </div>


                    <!-- Video Player -->
                    <div id="commonVideoWrapper4" style="display:none; margin-top:15px; background: rgba(0,0,0,0.7); padding: 15px; border-radius: 10px;">
                        <div class="d-flex justify-content-between align-items-center mb-2">
                            <h6 class="text-white mb-0">Now Playing: Database Design</h6>
                            <button onclick="closeVideo(4)" class="btn btn-sm btn-danger">
                                <i class="fas fa-times"></i> Close
                            </button>
                        </div>
                        <video id="courseVideo4" width="100%" controls style="border-radius: 8px;">
                            <source id="videoSource4" src="" type="video/mp4">
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Course 2: Cyber Security -->
            <div class="col-md-3 mb-3">
                <div class="course-card recommended">
                    <div class="card-body text-center">
                        <i class="fas fa-shield-alt fa-2x text-success mb-3"></i>
                        <h6 class="course-title">Cyber Security</h6>

                        <!-- Enroll Button (Initially visible) -->
                        <button class="btn btn-outline-primary btn-sm mt-2 enroll-btn"
                                onclick="enrollCourse('Cyber Security', this, 5)">
                            <i class="fas fa-plus-circle"></i> Enroll Now
                        </button>

                        <!-- Continue Button (Initially hidden) -->
                        <button class="btn btn-custom btn-sm mt-2 continue-btn"
                                onclick="continueCourse('Cyber Security',5)"
                                style="display: none;">
                            <i class="fas fa-play"></i> Continue
                        </button>

                        <!-- Success Message (Hidden initially) -->
                        <div class="alert alert-success success-msg mt-2 mb-0" style="display: none; padding: 8px 12px;">
                            <i class="fas fa-check-circle"></i> Enrolled Successfully!
                        </div>
                    </div>


                    <!-- Video Player -->
                    <div id="commonVideoWrapper5" style="display:none; margin-top:15px; background: rgba(0,0,0,0.7); padding: 15px; border-radius: 10px;">
                        <div class="d-flex justify-content-between align-items-center mb-2">
                            <h6 class="text-white mb-0">Now Playing: Cyber Security</h6>
                            <button onclick="closeVideo(5)" class="btn btn-sm btn-danger">
                                <i class="fas fa-times"></i> Close
                            </button>
                        </div>
                        <video id="courseVideo5" width="100%" controls style="border-radius: 8px;">
                            <source id="videoSource5" src="" type="video/mp4">
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Course 3: Cloud Computing -->
            <div class="col-md-3 mb-3">
                <div class="course-card recommended">
                    <div class="card-body text-center">
                        <i class="fas fa-cloud fa-2x text-info mb-3"></i>
                        <h6 class="course-title">Cloud Computing</h6>

                        <!-- Enroll Button (Initially visible) -->
                        <button class="btn btn-outline-primary btn-sm mt-2 enroll-btn"
                                onclick="enrollCourse('Cloud Computing', this, 6)">
                            <i class="fas fa-plus-circle"></i> Enroll Now
                        </button>

                        <!-- Continue Button (Initially hidden) -->
                        <button class="btn btn-custom btn-sm mt-2 continue-btn"
                                onclick="continueCourse('Cloud Computing', 6)"
                                style="display: none;">
                            <i class="fas fa-play"></i> Continue
                        </button>

                        <!-- Success Message (Hidden initially) -->
                        <div class="alert alert-success success-msg mt-2 mb-0" style="display: none; padding: 8px 12px;">
                            <i class="fas fa-check-circle"></i> Enrolled Successfully!
                        </div>
                    </div>


                    <!-- Video Player -->
                    <div id="commonVideoWrapper6" style="display:none; margin-top:15px; background: rgba(0,0,0,0.7); padding: 15px; border-radius: 10px;">
                        <div class="d-flex justify-content-between align-items-center mb-2">
                            <h6 class="text-white mb-0">Now Playing: Cloud Computing</h6>
                            <button onclick="closeVideo(6)" class="btn btn-sm btn-danger">
                                <i class="fas fa-times"></i> Close
                            </button>
                        </div>
                        <video id="courseVideo6" width="100%" controls style="border-radius: 8px;">
                            <source id="videoSource6" src="" type="video/mp4">
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>

            <!-- Course 4: React Native -->
            <div class="col-md-3 mb-3">
                <div class="course-card recommended">
                    <div class="card-body text-center">
                        <i class="fas fa-mobile-alt fa-2x text-warning mb-3"></i>
                        <h6 class="course-title">React Native</h6>

                        <!-- Enroll Button (Initially visible) -->
                        <button class="btn btn-outline-primary btn-sm mt-2 enroll-btn"
                                onclick="enrollCourse('React Native', this, 7)">
                            <i class="fas fa-plus-circle"></i> Enroll Now
                        </button>

                        <!-- Continue Button (Initially hidden) -->
                        <button class="btn btn-custom btn-sm mt-2 continue-btn"
                                onclick="continueCourse('React Native',7)"
                                style="display: none;">
                            <i class="fas fa-play"></i> Continue
                        </button>

                        <!-- Success Message (Hidden initially) -->
                        <div class="alert alert-success success-msg mt-2 mb-0" style="display: none; padding: 8px 12px;">
                            <i class="fas fa-check-circle"></i> Enrolled Successfully!
                        </div>
                    </div>


                    <!-- Video Player -->
                    <div id="commonVideoWrapper7" style="display:none; margin-top:15px; background: rgba(0,0,0,0.7); padding: 15px; border-radius: 10px;">
                        <div class="d-flex justify-content-between align-items-center mb-2">
                            <h6 class="text-white mb-0">Now Playing: React Native</h6>
                            <button onclick="closeVideo(7)" class="btn btn-sm btn-danger">
                                <i class="fas fa-times"></i> Close
                            </button>
                        </div>
                        <video id="courseVideo7" width="100%" controls style="border-radius: 8px;">
                            <source id="videoSource7" src="" type="video/mp4">
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
            </div>
        </div>
        <!-- NEW: Study Groups -->
        <div class="card mt-4">
            <div class="card-body">
                <h5 class="card-title"><i class="fas fa-users text-info"></i> Study Groups</h5>
                <div class="row mt-3">
                    <div class="col-md-6">
                        <div class="card study-group-card">
                            <h6>Web Development Study Group</h6>
                            <p class="text-muted">Discuss HTML, CSS, JavaScript and frameworks</p>
                            <div class="group-members">
                                <div class="member">A</div>
                                <div class="member">S</div>
                                <div class="member">R</div>
                                <div class="member">+5</div>
                            </div>
                            <button class="btn btn-outline-primary btn-sm mt-3">Join Group</button>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="card study-group-card">
                            <h6>Machine Learning Enthusiasts</h6>
                            <p class="text-muted">Share resources and solve problems together</p>
                            <div class="group-members">
                                <div class="member">M</div>
                                <div class="member">K</div>
                                <div class="member">J</div>
                                <div class="member">+8</div>
                            </div>
                            <button class="btn btn-outline-primary btn-sm mt-3">Join Group</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Assignments Section -->
    <!-- Assignments Section -->

    <div id="assignments" class="section">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h2 class="fw-bold mb-0" style="color: #ffffff; letter-spacing: -0.5px;">
                <i class="fas fa-tasks me-2" style="color: #6366f1;"></i> Assignments & Projects
            </h2>
            <button class="btn btn-primary rounded-pill px-4 shadow-sm fw-medium"
                    onclick="openCreateModal()"
                    style="transition: transform 0.2s;">
                <i class="fas fa-plus me-1"></i> New Assignment
            </button>
        </div>

        <div class="card shadow-sm border-0 mb-4" style="border-radius: 15px; background: #ffffff;">
            <div id="assignment-list-container" class="card-body p-0">
                <div class="text-center p-5">
                    <div class="spinner-border text-primary" role="status"></div>
                    <p class="mt-2 text-muted">Bhai, data load ho raha hai...</p>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="newAssignmentModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content border-0 shadow-lg" style="border-radius: 20px;">
                <div class="modal-header border-0 p-4 pb-0">
                    <h5 class="modal-title fw-bold text-dark"><i class="fas fa-plus-circle me-2 text-primary"></i>Add New Project</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body p-4">
                    <form id="newAssignmentForm">
                        <div class="mb-3">
                            <label class="form-label small text-muted fw-bold">Title</label>
                            <input type="text" class="form-control rounded-pill" id="taskTitle" required placeholder="e.g. Java Project">
                        </div>
                        <div class="mb-3">
                            <label class="form-label small text-muted fw-bold">Description</label>
                            <textarea class="form-control" id="taskDesc" rows="3" style="border-radius: 15px;" placeholder="Details here..."></textarea>
                        </div>
                        <div class="mb-3">
                            <label class="form-label small text-muted fw-bold">Due Date</label>
                            <input type="datetime-local" class="form-control rounded-pill" id="taskDate" required>
                        </div>
                        <button type="submit" class="btn btn-primary w-100 rounded-pill py-2 fw-bold">Save Assignment</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="viewModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content border-0 shadow-lg" style="border-radius: 20px;">
                <div class="modal-header border-0 p-4 pb-0">
                    <h5 class="modal-title fw-bold text-dark" id="vTitle">Project Details</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body p-4">
                    <p id="vDesc" class="text-muted"></p>
                    <div class="p-3 bg-light rounded-3">
                        <small class="text-secondary d-block">Deadline:</small>
                        <strong id="vDate" class="text-dark"></strong>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Progesss  Section -->
    <div id="progress" class="section">
        <div class="container-fluid">
            <h1 class="text-white mb-4"><i class="fas fa-chart-line"></i> Learning Progress</h1>

            <div class="row">
                <div class="col-md-8">
                    <div class="card mb-4 shadow-sm">
                        <div class="card-body">
                            <div class="d-flex justify-content-between align-items-center mb-4">
                                <h5 class="card-title mb-0">Course Completion Progress</h5>
                                <span class="badge bg-soft-primary text-primary">Live Tracking</span>
                            </div>

                            <div id="dynamic-course-list">
                                <div class="text-center p-5">
                                    <div class="spinner-border text-primary" role="status"></div>
                                    <p class="mt-2 text-muted">Fetching your learning data...</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-md-4">
                    <div class="card shadow-sm h-100">
                        <div class="card-body text-center d-flex flex-column justify-content-center">
                            <h5 class="text-muted">Overall Progress</h5>
                            <div id="overall-percentage" class="display-3 text-primary fw-bold my-3">0%</div>
                            <p id="progress-status-msg" class="text-muted px-3">Analyzing your data... ðŸŽ¯</p>

                            <div class="mt-4">
                                <button class="btn btn-primary w-100 py-2 mb-2" onclick="loadDashboardData()">
                                    <i class="fas fa-sync-alt me-2"></i> Refresh Stats
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row mt-4">
                <div class="col-md-6">
                    <div class="card h-100 shadow-sm">
                        <div class="card-body">
                            <h5 class="card-title"><i class="fas fa-clock text-info me-2"></i> Study Time</h5>
                            <div class="mt-4">
                                <div class="d-flex justify-content-between align-items-center mb-3">
                                    <span class="text-muted">This Week</span>
                                    <span class="fw-bold fs-5">18.5 hours</span>
                                </div>
                                <div class="d-flex justify-content-between align-items-center">
                                    <span class="text-muted">Daily Average</span>
                                    <span class="fw-bold fs-5">2.6 hours</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-md-6">
                    <div class="card h-100 shadow-sm">
                        <div class="card-body">
                            <h5 class="card-title"><i class="fas fa-trophy text-warning me-2"></i> Achievements</h5>
                            <div id="achievement-container" class="mt-4 d-flex flex-wrap">
                                <span class="badge bg-info text-dark me-2 mb-2 p-2 px-3"><i class="fas fa-fire me-1"></i> 7-Day Streak</span>
                                <span class="badge bg-success me-2 mb-2 p-2 px-3"><i class="fas fa-graduation-cap me-1"></i> Course Master</span>
                                <span class="badge bg-warning text-dark me-2 mb-2 p-2 px-3"><i class="fas fa-star me-1"></i> Top Learner</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row mt-4">
                <div class="col-12">
                    <div class="card shadow-sm">
                        <div class="card-body">
                            <h5 class="card-title mb-4"><i class="fas fa-crown text-warning me-2"></i> Class Leaderboard</h5>
                            <div id="leaderboard-container">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Resources Section -->
    <div id="resources" class="section">
        <h1 class="text-white mb-4"><i class="fas fa-file-alt"></i> Study Resources</h1>

        <div class="card">
            <div class="card-body">
                <!-- Database Design PDF -->
                <div class="resource-item d-flex justify-content-between align-items-center p-3 border-bottom">
                    <div class="d-flex align-items-center">
                        <i class="fas fa-file-pdf fa-2x text-danger me-3"></i>
                        <div>
                            <h5 class="mb-1">Database Design Guide</h5>
                            <p class="text-muted mb-0">SQL and NoSQL database design best practices</p>
                            <small class="text-info">
                                <i class="fas fa-hdd"></i> 2.4 MB â€¢
                                <i class="fas fa-file"></i> Database_Design.pdf
                            </small>
                        </div>
                    </div>
                    <button class="btn btn-custom" onclick="downloadResource('Database_Design.pdf', 'Database Design Guide')">
                        <i class="fas fa-download"></i> Download
                    </button>
                </div>

                <!-- HTML/CSS PDF -->
                <div class="resource-item d-flex justify-content-between align-items-center p-3 border-bottom">
                    <div class="d-flex align-items-center">
                        <i class="fas fa-file-pdf fa-2x text-primary me-3"></i>
                        <div>
                            <h5 class="mb-1">HTML & CSS Mastery</h5>
                            <p class="text-muted mb-0">Complete guide for web development beginners</p>
                            <small class="text-info">
                                <i class="fas fa-hdd"></i> 3.1 MB â€¢
                                <i class="fas fa-file"></i> Html.css.pdf
                            </small>
                        </div>
                    </div>
                    <button class="btn btn-custom" onclick="downloadResource('Html.css.pdf', 'HTML & CSS Mastery')">
                        <i class="fas fa-download"></i> Download
                    </button>
                </div>

                <!-- Machine Learning PDF -->
                <div class="resource-item d-flex justify-content-between align-items-center p-3 border-bottom">
                    <div class="d-flex align-items-center">
                        <i class="fas fa-file-pdf fa-2x text-success me-3"></i>
                        <div>
                            <h5 class="mb-1">Machine Learning Basics</h5>
                            <p class="text-muted mb-0">Algorithms, implementations, and best practices</p>
                            <small class="text-info">
                                <i class="fas fa-hdd"></i> 4.7 MB â€¢
                                <i class="fas fa-file"></i> MachineLearning.pdf
                            </small>
                        </div>
                    </div>
                    <button class="btn btn-custom" onclick="downloadResource('MachineLearning.pdf', 'Machine Learning Basics')">
                        <i class="fas fa-download"></i> Download
                    </button>
                </div>

                <!-- Python Notes PDF -->
                <div class="resource-item d-flex justify-content-between align-items-center p-3">
                    <div class="d-flex align-items-center">
                        <i class="fas fa-file-pdf fa-2x text-warning me-3"></i>
                        <div>
                            <h5 class="mb-1">Python Programming</h5>
                            <p class="text-muted mb-0">From basics to advanced Python concepts</p>
                            <small class="text-info">
                                <i class="fas fa-hdd"></i> 2.8 MB â€¢
                                <i class="fas fa-file"></i> Python_Notes.pdf
                            </small>
                        </div>
                    </div>
                    <button class="btn btn-custom" onclick="downloadResource('Python_Notes.pdf', 'Python Programming')">
                        <i class="fas fa-download"></i> Download
                    </button>
                </div>
            </div>
        </div>
    </div>
    <!-- AI Tutor Section -->
    <div id="ai-tutor" class="section">
        <h1 class="text-white mb-4"><i class="fas fa-robot"></i> AI Study Assistant</h1>

        <div class="row">
            <div class="col-md-8">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">Ask AI Tutor</h5>
                        <div class="ai-chat-container border rounded p-3 mb-3" id="aiChat">
                            <div class="ai-message bot-message">
                                <strong>AI Tutor:</strong> Hello! I'm your AI study assistant. Ask me anything about your courses, assignments, or concepts you're struggling with!
                            </div>
                        </div>
                        <div class="input-group">
                            <input type="text" class="form-control" id="aiQuestion" placeholder="Ask me anything about your studies..." onkeypress="handleKeyPress(event)">
                            <button class="btn btn-custom" onclick="askAI()">
                                <i class="fas fa-paper-plane"></i> Ask
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-md-4">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">Quick Questions</h5>
                        <button class="btn btn-outline-primary w-100 mb-2" onclick="quickQuestion('Explain machine learning in simple terms')">
                            Explain machine learning
                        </button>
                        <button class="btn btn-outline-primary w-100 mb-2" onclick="quickQuestion('Help with JavaScript closures')">
                            Help with JavaScript
                        </button>
                        <button class="btn btn-outline-primary w-100 mb-2" onclick="quickQuestion('Effective study tips for coding')">
                            Study tips
                        </button>
                        <button class="btn btn-outline-primary w-100 mb-2" onclick="quickQuestion('Web development project ideas')">
                            Project ideas
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- NEW: Pomodoro Timer Section -->
    <div id="pomodoro" class="section">
        <h1 class="text-white mb-4"><i class="fas fa-clock"></i> Focus Timer</h1>

        <div class="pomodoro-container glass">
            <h5 class="text-white"><i class="fas fa-stopwatch"></i> Pomodoro Timer</h5>
            <div class="pomodoro-options">
                <button class="pomodoro-btn active" onclick="setPomodoroTime(25)">Pomodoro (25min)</button>
                <button class="pomodoro-btn" onclick="setPomodoroTime(5)">Short Break (5min)</button>
                <button class="pomodoro-btn" onclick="setPomodoroTime(15)">Long Break (15min)</button>
            </div>
            <div class="timer-display" id="pomodoroDisplay">25:00</div>
            <div class="d-flex justify-content-center gap-3">
                <button class="btn btn-success" onclick="startPomodoroTimer()">
                    <i class="fas fa-play"></i> Start
                </button>
                <button class="btn btn-danger" onclick="stopPomodoroTimer()">
                    <i class="fas fa-stop"></i> Stop
                </button>
                <button class="btn btn-warning" onclick="resetPomodoroTimer()">
                    <i class="fas fa-redo"></i> Reset
                </button>
            </div>
        </div>

        <div class="card mt-4">
            <div class="card-body">
                <h5 class="card-title"><i class="fas fa-chart-pie text-primary"></i> Focus Sessions Today</h5>
                <div class="row mt-3 text-center">
                    <div class="col-md-4">
                        <div class="display-6 text-primary">3</div>
                        <small class="text-muted">Completed Sessions</small>
                    </div>
                    <div class="col-md-4">
                        <div class="display-6 text-success">75min</div>
                        <small class="text-muted">Total Focus Time</small>
                    </div>
                    <div class="col-md-4">
                        <div class="display-6 text-warning">25min</div>
                        <small class="text-muted">Current Streak</small>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ===== FLASH CARDS SECTION ===== -->
    <div id="flashcards" class="section">

        <h2 class="text-white mb-4">
            <i class="fas fa-layer-group"></i> Flash Cards
        </h2>

        <div class="row">

            <!-- CREATE FLASH CARD -->
            <div class="col-md-5">
                <div class="card shadow-sm">
                    <div class="card-body">

                        <h5>Create Flash Card</h5>

                        <textarea id="cardFront" class="form-control mb-2"
                                  placeholder="Enter Question"></textarea>

                        <textarea id="cardBack" class="form-control mb-3"
                                  placeholder="Enter Answer"></textarea>

                        <button class="btn btn-primary w-100" onclick="createFlashcard()">
                            <i class="fas fa-plus"></i> Add Card
                        </button>

                    </div>
                </div>
            </div>

            <!-- FLASH CARD LIST -->
            <div class="col-md-7">
                <div class="card shadow-sm">
                    <div class="card-body">
                        <h5>Your Cards</h5>
                        <div id="flashcardsContainer"></div>
                    </div>
                </div>
            </div>

        </div>

        <!-- PRACTICE MODE -->
        <div class="card mt-4 shadow-sm">
            <div class="card-body text-center">

                <h5>Practice</h5>

                <div class="flashcard" onclick="flipCard()" id="practiceCard">
                    <div class="flashcard-inner" id="practiceInner">
                        <div class="flashcard-front" id="practiceFront">
                            Click to Start : What is HTML ?
                        </div>
                        <div class="flashcard-back" id="practiceBack">
                            Answer : Hyper Text Markup Language.
                        </div>
                    </div>
                </div>



                <div class="mt-3">
                    <button class="btn btn-secondary me-2" onclick="previousCard()">Previous</button>
                    <button class="btn btn-success" onclick="nextCard()">Next</button>
                </div>

            </div>
        </div>

    </div>


    <!-- NEW: Notes Section -->
    <div id="notes" class="section">
        <h1 class="text-white mb-4"><i class="fas fa-sticky-note"></i> Notes</h1>

        <div class="card mb-4">
            <div class="card-body">
                <h5 class="card-title">Create New Note</h5>
                <div class="mb-3">
                    <input type="text" class="form-control" id="noteTitle" placeholder="Note Title">
                </div>
                <div class="mb-3">
                    <textarea class="form-control" id="noteContent" rows="5" placeholder="Start typing your note here..."></textarea>
                </div>
                <button class="btn btn-custom" onclick="createNote()">
                    <i class="fas fa-save"></i> Save Note
                </button>
            </div>
        </div>

        <div class="notes-container" id="notesContainer">
            <!-- Notes will be added here -->
        </div>
    </div>

    <!-- NEW: Calendar Section -->
    <div id="calendar" class="section">
        <h1 class="text-white mb-4"><i class="fas fa-calendar-alt"></i> Study Calendar</h1>
        <a class="nav-link" onclick="showSection('calendar')">
            <i class="fas fa-calendar-alt"></i> <span>Study Calendar</span>
        </a>
        <div class="card">
            <div class="card-body">
                <div class="calendar">
                    <div class="calendar-header">
                        <button class="btn btn-sm btn-outline-primary" onclick="previousMonth()">
                            <i class="fas fa-chevron-left"></i>
                        </button>
                        <h5 id="currentMonth">October 2025</h5>
                        <button class="btn btn-sm btn-outline-primary" onclick="nextMonth()">
                            <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>
                    <div class="calendar-grid" id="calendarGrid">
                        <!-- Calendar days will be generated here -->
                    </div>
                </div>
            </div>
        </div>

        <div class="card mt-4">
            <div class="card-body">
                <h5 class="card-title">Upcoming Events</h5>
                <div class="mt-3">
                    <div class="d-flex justify-content-between align-items-center p-3 border-bottom">
                        <div>
                            <h6 class="mb-1">Web Development Exam</h6>
                            <small class="text-muted">October 25, 2026 - 10:00 AM</small>
                        </div>
                        <span class="badge bg-danger">Exam</span>
                    </div>
                    <div class="d-flex justify-content-between align-items-center p-3 border-bottom">
                        <div>
                            <h6 class="mb-1">Machine Learning Project Due</h6>
                            <small class="text-muted">October 28, 2026 - 11:59 PM</small>
                        </div>
                        <span class="badge bg-warning">Assignment</span>
                    </div>
                    <div class="d-flex justify-content-between align-items-center p-3">
                        <div>
                            <h6 class="mb-1">Study Group Meeting</h6>
                            <small class="text-muted">October 30, 2026 - 3:00 PM</small>
                        </div>
                        <span class="badge bg-info">Meeting</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Floating Action Button -->
<div class="fab" onclick="toggleTheme()">
    <i class="fas fa-moon" id="themeIcon"></i>
</div>

<!-- Study Session Modal -->
<div class="modal-overlay" id="studySessionModal">
    <div class="modal-content">
        <h3><i class="fas fa-graduation-cap text-primary"></i> Study Session</h3>
        <div class="study-session">
            <h5 id="sessionTitle">Focused Study Session</h5>
            <div class="timer-display text-dark" id="sessionTimer">25:00</div>
            <div class="progress mb-3">
                <div class="progress-bar" id="sessionProgress" style="width: 0%"></div>
            </div>
            <div class="d-flex justify-content-between gap-2">
                <button class="btn btn-success flex-fill" onclick="startSessionTimer()">
                    <i class="fas fa-play"></i> Start
                </button>
                <button class="btn btn-danger flex-fill" onclick="pauseSessionTimer()">
                    <i class="fas fa-pause"></i> Pause
                </button>
                <button class="btn btn-warning flex-fill" onclick="endStudySession()">
                    <i class="fas fa-stop"></i> End
                </button>
                <audio id="alarmSound">
                    <source src="/images/video/alram.mp3" type="audio/mpeg">
                </audio>

            </div>
        </div>
    </div>
</div>

<!-- Course Details Modal -->
<div class="modal-overlay" id="courseDetailsModal">
    <div class="modal-content">
        <h3 id="courseModalTitle">Course Details</h3>
        <div id="courseModalContent">
            <!-- Course details will be loaded here -->
        </div>
        <button class="btn btn-custom w-100 mt-3" onclick="closeModal('courseDetailsModal')">
            Close
        </button>
    </div>
</div>

<!-- Assignment Modal -->
<div class="modal-overlay" id="assignmentModal">
    <div class="modal-content">
        <h3 id="assignmentModalTitle">Assignment Details</h3>
        <div id="assignmentModalContent">
            <!-- Assignment details will be loaded here -->
        </div>
        <button class="btn btn-custom w-100 mt-3" onclick="closeModal('assignmentModal')">
            Close
        </button>
    </div>
</div>

<!-- Notification Container -->
<div id="notificationContainer"></div>

<script>



    // Navigation System
    function showSection(sectionId) {
        // Hide all sections
        document.querySelectorAll('.section').forEach(section => {
            section.classList.remove('active');
        });

        // Show selected section
        document.getElementById(sectionId).classList.add('active');

        // Update active nav link
        document.querySelectorAll('.nav-link').forEach(link => {
            link.classList.remove('active');
        });

        // Find and activate the clicked nav link
        const navLinks = document.querySelectorAll('.nav-link');
        for (let link of navLinks) {
            if (link.textContent.includes(sectionId.charAt(0).toUpperCase() + sectionId.slice(1).replace('-', ' '))) {
                link.classList.add('active');
                break;
            }
        }

        showNotification(`Navigated to ${sectionId.replace('-', ' ')}`);

        // Close sidebar on mobile after navigation
        if (window.innerWidth <= 768) {
            document.getElementById('sidebar').classList.remove('active');
        }
    }
    // Example: username comes from backend API or session
    // Let's say you have it in a JS variable
    let username = "Guest"; // default

    // If username comes from backend (Spring Boot session or REST API)
    fetch("/api/user/profile") // make your endpoint to get user info
        .then(res => res.json())
        .then(data => {
            username = data.username; // backend returns {username: "Anurag Gupta"}
            updateDashboardUsername(username);
        })
        .catch(err => console.log("Failed to load username:", err));

    function updateDashboardUsername(name) {
        const userNameDiv = document.querySelector(".user-name");
        if (userNameDiv) {
            userNameDiv.textContent = name + " ji"; // optional honorific
        }
    }


    // Notification System
    function showNotification(message) {
        const notification = document.createElement('div');
        notification.className = 'notification';
        notification.textContent = message;
        document.getElementById('notificationContainer').appendChild(notification);

        // Show notification
        setTimeout(() => notification.classList.add('show'), 100);

        // Hide and remove notification after 3 seconds
        setTimeout(() => {
            notification.classList.remove('show');
            setTimeout(() => notification.remove(), 300);
        }, 3000);
    }

    // Modal System
    function showModal(modalId) {
        document.getElementById(modalId).classList.add('active');
    }

    function closeModal(modalId) {
        document.getElementById(modalId).classList.remove('active');
    }
    const courseVideos = {
        'Full Stack Web Development': '/video/fullstack.mp4',
        'Machine Learning & AI': '/video/ml.mp4',
        'Flutter App Development': '/video/flutter.mp4'
    };
    // Course Functions - FULLY WORKING
    function continueCourse(courseName) {
        showNotification(`ðŸš€ Starting "${courseName}"... Loading video...`);

        setTimeout(() => {
            const videoUrl = courseVideos[courseName];

            if (videoUrl) {

                // Set modal title
                document.getElementById('courseModalTitle').textContent = courseName;

                // Set modal content
                document.getElementById('courseModalContent').innerHTML = `
                <video width="100%" controls autoplay style="border-radius: 10px;">
                    <source src="/videos/flutter.mp4" type="video/mp4">
                    Your browser does not support the video tag.
                </video>

                <p class="mt-3 text-white">
                    <strong>Now Playing:</strong> ${courseName}
                </p>
            `;

                // Open modal
                showModal('courseDetailsModal');

            } else {
                showNotification(`âš ï¸ No video found for "${courseName}".`);
            }
        }, 1000);
    }


    function showCourseDetails(courseName) {
        const courseData = {
            'Full Stack Web Development': {
                description: 'Complete web development course covering frontend and backend technologies.',
                modules: '18 modules',
                duration: '120 hours',
                instructor: 'Shardha Khapra',
                rating: '4.8/5',
                video:'flutter1.mp4'
            },
            'Machine Learning & AI': {
                description: 'Comprehensive AI and machine learning course with hands-on projects.',
                modules: '19 modules',
                duration: '95 hours',
                instructor: 'Dr. Alex Chen',
                rating: '4.9/5',
                video:'flutter1.mp4'
            },
            'Flutter App Development': {
                description: 'Build beautiful cross-platform mobile applications with Flutter.',
                modules: '18 modules',
                duration: '80 hours',
                instructor: 'Mike Thompson',
                rating: '4.7/5',
                video:'flutter1.mp4'
            }
        };

        const course = courseData[courseName] || {
            description: 'Comprehensive course with expert instruction.',
            modules: '15 modules',
            duration: '75 hours',
            instructor: 'Expert Instructor',
            rating: '4.5/5',
            video:'flutter1.mp4'
        };

        document.getElementById('courseModalTitle').textContent = courseName;
        document.getElementById('courseModalContent').innerHTML = `
            <p><strong>Description:</strong> ${course.description}</p>
            <p><strong>Modules:</strong> ${course.modules}</p>
            <p><strong>Duration:</strong> ${course.duration}</p>
            <p><strong>Instructor:</strong> ${course.instructor}</p>
            <p><strong>Rating:</strong> ${course.rating}</p>
            <div class="progress mt-3">
                <div class="progress-bar" style="width: ${Math.floor(Math.random() * 30) + 60}%"></div>
            </div>
        `;
        showModal('courseDetailsModal');
    }
    function enrollCourse(courseName) {
        showNotification(`ðŸ“š Enrolling in "${courseName}"...`);

        setTimeout(() => {
            showNotification(`ðŸŽ‰ Successfully enrolled in "${courseName}"! Added to My Courses.`);

            const courseContainer = document.getElementById("myCourses");

            // Course images aur details
            const courseData = {
                "Database Design": {
                    img: "/images/database.png",
                    description: "Learn database concepts, design ER diagrams, and write SQL queries.",
                    modules: 12,
                    video: "/video/video2.mp4"
                },
                "Cyber Security": {
                    img: "/images/cybersecurity.png",
                    description: "Understand cybersecurity fundamentals, threats, and prevention methods.",
                    modules: 10,
                    video: "/video/flutter1.mp4"
                },
                "Cloud Computing": {
                    img: "/images/cloud.png",
                    description: "Explore cloud services, deployment models, and hands-on exercises.",
                    modules: 8,
                    video: "/video/flutter1.mp4"
                },
                "React Native": {
                    img: "/images/react.png",
                    description: "Build cross-platform mobile apps using React Native and Expo.",
                    modules: 15,
                    video: "/video/webDevelopment.mp4"
                }
            };

            const data = courseData[courseName] || {
                img: "/images/default.png",
                description: "No description available.",
                modules: 10
            };

            const card = document.createElement("div");
            card.className = "col-md-4 mb-4";
            card.innerHTML = `
            <div class="card course-card">
                <img src="${data.img}" class="course-img" alt="${courseName}">
                <div class="course-content">
                    <h5>${courseName}</h5>
                    <p class="text-muted">${data.description}</p>

                    <div class="progress">
                        <div class="progress-bar" style="width: 0%"></div>
                    </div>

                    <div class="d-flex justify-content-between mt-2">
                        <small>0% Complete</small>
                        <small>0/${data.modules} Modules</small>
                    </div>

                    <button class="btn btn-custom btn-sm mt-3" onclick="continueCourse('${courseName}')">
                        <i class="fas fa-play"></i> Continue
                    </button>
                </div>
            </div>
        `;

            courseContainer.appendChild(card);

        }, 1500);
    }

    // Updated continueCourse function
    function continueCourse(courseName, btn, wrapperNum) {
        const courseVideos = {
            "Full Stack Web Development": "/images/video/webDevelopment.mp4",
            "Machine Learning & AI": "/images/video/video2.mp4",
            "Flutter App Development": "/images/video/flutter1.mp4",
            "Database Design": "/images/video/database.mp4",
            "Cyber Security": "/images/video/security.mp4",
            "Cloud Computing": "/images/video/cloud.mp4",
            "React Native": "/images/video/webDevelopment.mp4"
        };

        const videoPath = courseVideos[courseName];
        if (!videoPath) {
            alert("Video not found!");
            return;
        }

        // Use the wrapper number to select correct elements
        const wrapper = document.getElementById("commonVideoWrapper" + wrapperNum);
        const video = document.getElementById("courseVideo" + wrapperNum);
        const source = document.getElementById("videoSource" + wrapperNum);

        source.src = videoPath;
        video.load();
        video.play();
        wrapper.style.display = "block";

        // Scroll video into view
        wrapper.scrollIntoView({ behavior: "smooth", block: "center" });
    }

    // Updated closeVideo function
    function closeVideo(wrapperNum) {
        const wrapper = document.getElementById("commonVideoWrapper" + wrapperNum);
        if (!wrapper) return;

        const video = document.getElementById("courseVideo" + wrapperNum);
        video.pause();
        video.currentTime = 0;
        wrapper.style.display = "none";
    }
    // Enroll Course Function - Yeh add karna hai
    function enrollCourse(courseName, button, wrapperNum) {
        // Hide enroll button
        button.style.display = "none";

        // Find parent card-body
        const cardBody = button.closest('.card-body');

        // Show continue button
        const continueBtn = cardBody.querySelector('.continue-btn');
        continueBtn.style.display = "block";

        // Show success message
        const successMsg = cardBody.querySelector('.success-msg');
        successMsg.style.display = "block";

        // Hide success message after 2 seconds
        setTimeout(() => {
            successMsg.style.display = "none";
        }, 2000);

        // Save enrollment status to localStorage
        let enrolledCourses = JSON.parse(localStorage.getItem('enrolledCourses')) || {};
        enrolledCourses[courseName] = {
            enrolled: true,
            progress: 0,
            lastWatched: new Date().toISOString()
        };
        localStorage.setItem('enrolledCourses', JSON.stringify(enrolledCourses));

        // Start the course immediately (optional)
        // continueCourse(courseName, wrapperNum);
    }

    // Updated continueCourse function - FIXED VERSION
    function continueCourse(courseName, wrapperNum) {
        const courseVideos = {
            "Full Stack Web Development": "/images/video/webDevelopment.mp4",
            "Machine Learning & AI": "/images/video/machine.mp4",
            "Flutter App Development": "/images/video/flutter3.mp4",
            "Database Design": "/images/video/database.mp4",
            "Cyber Security": "/images/video/security.mp4",
            "Cloud Computing": "/images/video/cloud.mp4",
            "React Native": "/images/video/react.mp4"
        };

        const videoPath = courseVideos[courseName];
        if (!videoPath) {
            alert("Video not found!");
            return;
        }

        // Use the wrapper number to select correct elements
        const wrapper = document.getElementById("commonVideoWrapper" + wrapperNum);
        const video = document.getElementById("courseVideo" + wrapperNum);
        const source = document.getElementById("videoSource" + wrapperNum);

        // Check if video is already loaded
        if (source.src.includes(videoPath)) {
            // Video already loaded, just play it
            wrapper.style.display = "block";
            video.play();
        } else {
            // Load new video
            source.src = videoPath;
            video.load();
            wrapper.style.display = "block";
            video.play().catch(error => {
                console.log("Auto-play prevented:", error);
            });
        }

        // Scroll video into view
        wrapper.scrollIntoView({ behavior: "smooth", block: "center" });

        // Update progress in localStorage
        updateCourseProgress(courseName);
    }

    // Function to update course progress
    function updateCourseProgress(courseName) {
        let enrolledCourses = JSON.parse(localStorage.getItem('enrolledCourses')) || {};
        if (enrolledCourses[courseName]) {
            // Increment progress by 5% each time video is watched
            enrolledCourses[courseName].progress = Math.min(
                (enrolledCourses[courseName].progress || 0) + 5,
                100
            );
            enrolledCourses[courseName].lastWatched = new Date().toISOString();
            localStorage.setItem('enrolledCourses', JSON.stringify(enrolledCourses));
        }
    }

    // Updated closeVideo function - IMPROVED
    function closeVideo(wrapperNum) {
        const wrapper = document.getElementById("commonVideoWrapper" + wrapperNum);
        if (!wrapper) return;

        const video = document.getElementById("courseVideo" + wrapperNum);
        video.pause();
        wrapper.style.display = "none";
    }

    // Function to check enrollment status on page load
    function checkEnrollmentStatus() {
        let enrolledCourses = JSON.parse(localStorage.getItem('enrolledCourses')) || {};

        // For Recommended Courses section (wrapperNum 4-7)
        for (let i = 4; i <= 7; i++) {
            const wrapper = document.getElementById("commonVideoWrapper" + i);
            if (wrapper) {
                const cardBody = wrapper.previousElementSibling.querySelector('.card-body');
                if (cardBody) {
                    const courseTitle = cardBody.querySelector('.course-title').textContent;

                    if (enrolledCourses[courseTitle]) {
                        // Hide enroll button
                        const enrollBtn = cardBody.querySelector('.enroll-btn');
                        if (enrollBtn) enrollBtn.style.display = "none";

                        // Show continue button
                        const continueBtn = cardBody.querySelector('.continue-btn');
                        if (continueBtn) continueBtn.style.display = "block";
                    }
                }
            }
        }
    }

    // Add this to your page load/ready event
    document.addEventListener('DOMContentLoaded', function() {
        checkEnrollmentStatus();
    });

    function findCourses() {
        const keyword = document.getElementById("searchInput").value.toLowerCase();
        const courses = document.querySelectorAll(".course-card");

        let foundCount = 0;

        courses.forEach(course => {
            const title = course.querySelector(".course-title").innerText.toLowerCase();

            if (title.includes(keyword)) {
                course.style.display = "block";
                foundCount++;
            } else {
                course.style.display = "none";
            }
        });

        if (foundCount > 0) {
            showNotification(`ðŸ“– Found ${foundCount} matching courses!`);
        } else {
            showNotification("âŒ Course not found!");
        }
    }


    // Notification function
    function showNotification(message) {
        const box = document.createElement("div");
        box.className = "notification-box";
        box.innerHTML = message;

        document.body.appendChild(box);

        // Show with animation
        setTimeout(() => box.classList.add("show"), 100);

        // Hide after 3 seconds
        setTimeout(() => {
            box.classList.remove("show");
            setTimeout(() => box.remove(), 500);
        }, 3000);
    }

    // Add click listeners to all "Join Group" buttons dynamically
    document.addEventListener("DOMContentLoaded", () => {
        document.querySelectorAll(".study-group-card button").forEach(button => {
            button.addEventListener("click", function() {
                const groupName = this.closest(".study-group-card").querySelector("h6").innerText;

                // Create notification div
                const notification = document.createElement("div");
                notification.innerText = `ðŸŽ‰ You have successfully joined the "${groupName}" group!`;
                notification.style.position = "fixed";
                notification.style.bottom = "20px";
                notification.style.right = "20px";
                notification.style.backgroundColor = "#4caf50";
                notification.style.color = "#fff";
                notification.style.padding = "10px 20px";
                notification.style.borderRadius = "8px";
                notification.style.boxShadow = "0 4px 6px rgba(0,0,0,0.2)";
                notification.style.zIndex = "1000";
                notification.style.opacity = "0";
                notification.style.transition = "opacity 0.5s ease";

                document.body.appendChild(notification);

                // Fade in
                requestAnimationFrame(() => {
                    notification.style.opacity = "1";
                });

                // Remove after 3 seconds
                setTimeout(() => {
                    notification.style.opacity = "0";
                    notification.addEventListener("transitionend", () => notification.remove());
                }, 3000);
            });
        });
    });



    // ------------------------------
    // GLOBAL UTILITY FUNCTIONS
    // ------------------------------
    function showNotification(message) {
        const box = document.createElement("div");
        box.className = "notification-box";
        box.innerHTML = message;

        document.body.appendChild(box);

        setTimeout(() => {
            box.classList.add("show");
        }, 100);

        setTimeout(() => {
            box.classList.remove("show");
            setTimeout(() => box.remove(), 500);
        }, 2500);
    }

    function showModal(id) {
        document.getElementById(id).classList.add("active");
    }
    function closeModal(id) {
        document.getElementById(id).classList.remove("active");
    }
    // Section - 3 Assigment
    // ------------------------------
    // Section - 3 Assignment Logic
    // ------------------------------

    // 1. Helper function to get ID safely
    function getUserId() {
        const id = sessionStorage.getItem("userId");
        // Agar ID nahi milti toh default 83 (test ke liye) ya null return karein
        return (id && id !== "null") ? id : 83;
    }

    // 2. Fetch Assignments from Backend
    async function fetchAssignments() {
        const container = document.getElementById('assignment-list-container');
        const userId = getUserId(); // Har baar fresh ID uthayein

        if (!userId) {
            container.innerHTML = '<p class="text-center p-4 text-warning">Please login to see assignments.</p>';
            return;
        }

        try {
            const res = await fetch(`/api/assignments/user/${userId}`);
            if (!res.ok) throw new Error("Fetch failed");

            const data = await res.json();

            if (data.length === 0) {
                container.innerHTML = '<div class="p-5 text-center text-muted">Abhi koi assignment nahi hai. Naya banayein!</div>';
                return;
            }

            container.innerHTML = data.map(task => {
                const isSubmitted = task.status === "Submitted";
                // Buttons mein data- attributes add karein taaki dynamic event listener kaam kare
                return `
            <div class="assignment-item d-flex justify-content-between align-items-center p-3 border-bottom">
                <div>
                    <h5 class="mb-1 fw-bold text-dark">${task.title}</h5>
                    <p class="text-muted mb-0 small">${task.description || ''}</p>
                    <small class="${isSubmitted ? 'text-success' : 'text-danger'}">
                        <i class="fas ${isSubmitted ? 'fa-check-circle' : 'fa-clock'}"></i>
                        ${isSubmitted ? 'Submitted' : 'Due: ' + new Date(task.dueDate).toLocaleDateString()}
                    </small>
                </div>
                <div class="d-flex align-items-center gap-2">
                    ${!isSubmitted ? `
                        <button class="btn btn-success btn-sm rounded-pill px-3"
                                data-action="submit" data-id="${task.id}" data-name="${task.title}">
                            <i class="fas fa-paper-plane"></i> Submit
                        </button>
                    ` : `
                        <button class="btn btn-outline-secondary btn-sm rounded-pill px-3"
                                data-action="download" data-name="${task.title}">
                            <i class="fas fa-download"></i> Download
                        </button>
                    `}
                    <button class="btn btn-outline-primary btn-sm rounded-pill px-3"
                            onclick="viewTask('${task.title}', '${task.description}', '${task.dueDate}')">
                        <i class="fas fa-eye"></i> View
                    </button>
                </div>
            </div>`;
            }).join('');
        } catch (err) {
            console.error(err);
            container.innerHTML = '<p class="text-center p-4 text-danger">Server error! Check connectivity.</p>';
        }
    }

    // 3. Submit Assignment (Fixed logic)
    async function submitTask(id, name) {
        const userId = getUserId();

        if (userId === 83) { // Agar default use ho raha hai toh warning dein
            console.warn("Using default testing ID 83");
        }

        if(!confirm(`Kya aap "${name}" submit karna chahte hain?`)) return;

        try {
            // userId query param mein bhejna backend ki requirement ke hisaab se sahi hai
            const res = await fetch(`/api/assignments/${id}/submit?userId=${userId}`, { method: 'PUT' });

            if (res.ok) {
                alert("Assignment successfully submit ho gaya!");
                fetchAssignments(); // Refresh list
            } else {
                const errorMsg = res.status === 403 ? "Unauthorized attempt!" : "Submission fail ho gayi.";
                alert(errorMsg);
            }
        } catch (err) {
            alert("Network error!");
        }
    }

    // 4. Create New Assignment
    document.getElementById('newAssignmentForm')?.addEventListener('submit', async function(e) {
        e.preventDefault();
        const userId = getUserId();

        const payload = {
            title: document.getElementById('taskTitle').value,
            description: document.getElementById('taskDesc').value,
            dueDate: document.getElementById('taskDate').value,
            status: "Pending"
        };

        try {
            const res = await fetch(`/api/assignments/user/${userId}`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
            });

            if (res.ok) {
                const modalEl = document.getElementById('newAssignmentModal');
                const modal = bootstrap.Modal.getInstance(modalEl);
                modal.hide();
                this.reset();
                fetchAssignments();
            }
        } catch (err) { console.error(err); }
    });

    // 5. DYNAMIC EVENT DELEGATION (Fixing your Click Handler)
    document.addEventListener("click", function (e) {
        const btn = e.target.closest("[data-action]");
        if (!btn) return;

        const action = btn.getAttribute("data-action");
        const name = btn.getAttribute("data-name");
        const id = btn.getAttribute("data-id");

        if (action === "submit") {
            submitTask(id, name);
        } else if (action === "download") {
            alert("Downloading " + name + "...");
        }
        // Baaki actions (view, work) yahan add kar sakte hain
    });
    // 6. View Task Details Function
    function viewTask(title, desc, date) {
        // Modal ke elements mein data fill karein
        document.getElementById('vTitle').innerText = title;
        document.getElementById('vDesc').innerText = desc || "No description provided.";

        // Date format sahi karein
        const formattedDate = new Date(date).toLocaleString('en-IN', {
            dateStyle: 'medium',
            timeStyle: 'short'
        });
        document.getElementById('vDate').innerText = formattedDate;

        // Bootstrap Modal ko show karein
        const viewModalEl = document.getElementById('viewModal');
        const viewModal = new bootstrap.Modal(viewModalEl);
        viewModal.show();
    }
    // 7. Open Create Modal Function
    function openCreateModal() {
        const createModalEl = document.getElementById('newAssignmentModal');
        const createModal = new bootstrap.Modal(createModalEl);
        createModal.show();
    }

    // 8. Event Listener Update (Click Handler)
    document.addEventListener("click", function (e) {
        const btn = e.target.closest("[data-action]");
        if (!btn) return;

        const action = btn.getAttribute("data-action");

        // Naya logic yahan add karein
        if (action === "new") {
            openCreateModal();
        } else if (action === "submit") {
            const id = btn.getAttribute("data-id");
            const name = btn.getAttribute("data-name");
            submitTask(id, name);
        }
        // ... baki actions
    });

    // Initial Load
    document.addEventListener("DOMContentLoaded", fetchAssignments);
    // --------------------------------------
    // DYNAMIC BUTTON EVENT HANDLER (FIXED)
    // --------------------------------------
    document.addEventListener("click", function (e) {
        const btn = e.target.closest("[data-action]");
        if (!btn) return;

        const action = btn.getAttribute("data-action");
        const name = btn.getAttribute("data-name") || "Untitled Assignment";
        const id = btn.getAttribute("data-id"); // ID catch karein

        const actionMap = {
            "view": () => viewAssignment(id, name),
            "submit": () => submitAssignment(id, name),
            "work": () => workOnAssignment(name),
            "download": () => viewSubmission(name),
            "new": () => createNewAssignment()
        };

        if (actionMap[action]) actionMap[action]();
    });
    // ==========================================
    // PROGRESS SECTION - 4 (COMPLETE FIXED CODE)
    // ==========================================

    /**
     * Smart Study Pro: A to Z Interactive System
     * Handles: User Session, Video Tracking, Progress & Leaderboard
     */
    // ==========================================
    // PROGRESS SECTION - FINAL UPDATED CODE
    // ==========================================

    /**
     * Smart Study Pro: A to Z Interactive System
     * Features: Session, Video Tracking, Dynamic Course List & Overall Progress
     */

    // ======================================================
    // SMART STUDY PRO: COMPLETE A-Z PROGRESS MODULE
    // ======================================================

    /**
     * Global Configuration
     * API_BASE_URL: Backend endpoint for progress
     * loggedInUser: Stores session data
     */
    let loggedInUser = { id: null, username: "Learner" };
    const API_BASE_URL = "http://localhost:8089/api/progress";

    // --- 1. INITIALIZATION ---
    document.addEventListener('DOMContentLoaded', async () => {
        console.log("ðŸš€ System Initializing...");

        // User session load karein
        const success = await initializeUserSession();

        if (success) {
            setupVideoTracking();    // Video listeners set karein
            loadDashboardData();     // Individual & Overall stats load karein
            loadLeaderboard();       // Global ranking load karein
        } else {
            console.error("âŒ Auth Error: User session not found.");
        }
    });

    // --- 2. SESSION MANAGEMENT ---
    async function initializeUserSession() {
        try {
            const response = await fetch('/auth/me');
            if (!response.ok) return false;

            const data = await response.json();
            loggedInUser.id = data.id;
            loggedInUser.username = data.username;

            console.log(`âœ… Welcome back, ${loggedInUser.username}`);
            return true;
        } catch (err) {
            console.error("Session Fetch Error:", err);
            return false;
        }
    }

    // --- 3. VIDEO TRACKING LOGIC ---
    function setupVideoTracking() {
        // Sabhi course videos (1-7) par event listener lagana
        for (let i = 1; i <= 7; i++) {
            const video = document.getElementById(`courseVideo${i}`);
            if (!video) continue;

            // Jab video khatam ho
            video.onended = async function() {
                const courseId = video.getAttribute('data-course-id');
                if (!courseId) return;

                try {
                    // Backend call to update progress in DB
                    const response = await fetch(`${API_BASE_URL}/update?userId=${loggedInUser.id}&courseId=${courseId}`, {
                        method: 'POST'
                    });

                    if (response.ok) {
                        // Professional Success Message
                        alert(`Congratulations, ${loggedInUser.username}! ðŸŽ‰ \nYou have successfully completed this module. Your progress has been updated by +10%! ðŸŽ¯`);

                        // UI Refresh karein bina page reload kiye
                        await Promise.all([loadDashboardData(), loadLeaderboard()]);
                    }
                } catch (err) {
                    console.error("Progress Update Failed:", err);
                }
            };
        }
    }

    // --- 4. DASHBOARD & OVERALL PROGRESS CALCULATION ---
    async function loadDashboardData() {
        const container = document.getElementById('dynamic-course-list');
        const overallText = document.getElementById('overall-percentage');
        const statusMsg = document.getElementById('progress-status-msg');

        // --- CHANGE 1: Dashboard card ki ID yaha add ki ---
        const dashboardCardText = document.getElementById('overall-progress-dashboard');

        if (!container || !loggedInUser.id) return;

        try {
            const res = await fetch(`${API_BASE_URL}/user/${loggedInUser.id}`);
            const courses = await res.json();

            container.innerHTML = '';
            let totalPercentage = 0;

            if (!courses || courses.length === 0) {
                container.innerHTML = '<div class="alert alert-info">No progress data found.</div>';
                if (overallText) overallText.innerText = "0%";
                if (dashboardCardText) dashboardCardText.innerText = "0%"; // Dashboard ko reset karein
                return;
            }

            courses.forEach(c => {
                const name = c.courseName || "Course";
                const pct = Math.round(c.progressPercentage || 0);
                totalPercentage += pct;

                container.innerHTML += `
            <div class="mb-4 p-3 shadow-sm" style="background: #1e293b; border-radius: 15px; border: 1px solid #334155;">
                <div class="d-flex justify-content-between align-items-center mb-2">
                    <span class="text-white fw-bold"><i class="fas fa-graduation-cap me-2 text-primary"></i>${name}</span>
                    <span class="badge bg-success rounded-pill px-3">${pct}%</span>
                </div>
                <div class="progress" style="height: 12px; background: #0f172a; border-radius: 10px;">
                    <div class="progress-bar progress-bar-striped progress-bar-animated"
                         role="progressbar"
                         style="width: ${pct}%; background: linear-gradient(90deg, #6366f1, #a855f7);"
                         aria-valuenow="${pct}" aria-valuemin="0" aria-valuemax="100">
                    </div>
                </div>
            </div>`;
            });

            const average = Math.round(totalPercentage / courses.length);

            // --- CHANGE 2: Dashboard card ki value yaha update ki ---
            if (dashboardCardText) {
                dashboardCardText.innerText = `${average}%`;
            }

            if (overallText) {
                overallText.innerText = `${average}%`;
            }

            if (statusMsg) {
                if (average === 0) statusMsg.innerText = "Start your first module today! ðŸŽ¯";
                else if (average < 50) statusMsg.innerText = "Good start! You are making progress. ðŸš€";
                else if (average < 100) statusMsg.innerText = "Doing great! Almost there! ðŸ”¥";
                else statusMsg.innerText = "Master! You have completed everything! ðŸ†";
            }

        } catch (e) {
            console.error("Dashboard Load Error:", e);
            container.innerHTML = '<div class="alert alert-danger">Error fetching dashboard data.</div>';
        }
    }

    // --- 5. LEADERBOARD UPDATED ---
    async function loadLeaderboard() {
        const lb = document.getElementById('leaderboard-container');
        if (!lb) return;

        try {
            const res = await fetch(`/api/progress/leaderboard`);
            const data = await res.json();

            if (!data || data.length === 0) {
                lb.innerHTML = '<div class="text-muted p-3 text-center">No data available.</div>';
                return;
            }

            lb.innerHTML = data.map((item, i) => {
                const name = item.username || "Learner";
                const progressValue = item.progress || 0;
                const progress = parseFloat(progressValue).toFixed(1);
                const isMe = (name === loggedInUser.username);

                return `
            <div class="leader-item ${isMe ? 'is-me' : ''} d-flex justify-content-between align-items-center p-3 mb-2 shadow-sm"
                 style="background: ${isMe ? 'rgba(99, 102, 241, 0.15)' : 'rgba(128, 128, 128, 0.05)'};
                        border: 1px solid ${isMe ? '#6366f1' : 'rgba(128, 128, 128, 0.1)'};
                        border-radius: 12px;
                        color: inherit;">
                <div class="d-flex align-items-center">
                    <span class="me-3 fw-bold ${isMe ? 'text-primary' : 'text-muted'}" style="min-width: 25px;">${i + 1}</span>
                    <span class="fw-medium">
                        ${name} ${isMe ? '<span class="badge bg-primary ms-1" style="font-size: 0.65rem;">YOU</span>' : ''}
                    </span>
                </div>
                <span class="fw-bold" style="color: #10b981;">${progress}%</span>
            </div>`;
            }).join('');
        } catch (e) {
            console.error("Leaderboard UI Error:", e);
        }
    }
    // --- 6. VIDEO PLAYER CONTROLS ---
    window.continueCourse = function(courseTitle, num) {
        const video = document.getElementById(`courseVideo${num}`);
        const wrapper = document.getElementById(`commonVideoWrapper${num}`);

        if (video && wrapper) {
            wrapper.style.display = 'block';
            video.setAttribute('data-course-id', num); // Syncing ID with backend

            const videoPaths = {
                1: "/images/video/webDevelopment1.mp4",
                2: "/images/video/machine1.mp4",
                3: "/images/video/flutter4.mp4",
                4: "/images/video/database2.mp4",
                5: "/images/video/security2.mp4",
                6: "/images/video/cloud2.mp4",
                7: "/images/video/cloud2.mp4"
            };

            video.src = videoPaths[num] || "/images/video/default.mp4";
            video.load();
            video.play();
            wrapper.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }
    };

    window.closeVideo = function(num) {
        const wrapper = document.getElementById(`commonVideoWrapper${num}`);
        const video = document.getElementById(`courseVideo${num}`);
        if (wrapper) wrapper.style.display = 'none';
        if (video) video.pause();
    };
    // âœ…Resources  CORRECT VERSION - FULLY WORKING
    function downloadResource(resourceName) {
        showNotification(`ðŸ“¥ Starting download: "${resourceName}"...`);

        let progress = 0;
        const interval = setInterval(() => {
            progress += 20;
            showNotification(`ðŸ“¥ Downloading "${resourceName}"... ${progress}%`);

            if (progress >= 100) {
                clearInterval(interval);

                // âœ… CORRECT PATH FOR SPRING BOOT
                const link = document.createElement('a');
                link.href = `/notes1/${resourceName}`;  // âœ… Only this!
                link.download = resourceName;
                link.style.display = 'none';

                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);

                setTimeout(() => {
                    showNotification(`âœ… "${resourceName}" downloaded successfully!`);
                }, 500);
            }
        }, 300);
    }

    // Progress Functions - FULLY WORKING
    function showStudyAnalytics() {
        showNotification('ðŸ“Š Opening detailed study analytics dashboard...');
        setTimeout(() => {
            showNotification('ðŸ“ˆ Analytics loaded! View your learning patterns.');
        }, 1500);
    }

    function startStudySession() {
        document.getElementById('sessionTitle').textContent = 'Focused Study Session';
        showModal('studySessionModal');
    }

    function startClassSession(className) {
        document.getElementById('sessionTitle').textContent = `${className} Class`;
        showModal('studySessionModal');
    }

    // Study Session Timer
    let sessionTimer;
    let sessionSeconds = 25 * 60;
    let sessionRunning = false;

    function startSessionTimer() {
        if (sessionRunning) return;

        sessionRunning = true;
        sessionTimer = setInterval(() => {
            sessionSeconds--;
            updateSessionTimer();

            if (sessionSeconds <= 0) {
                clearInterval(sessionTimer);
                sessionRunning = false;
                showNotification('ðŸŽ‰ Study session completed! Take a break.');
                document.getElementById('sessionTimer').classList.add('text-success');
            }
        }, 1000);

        showNotification('â° Study session timer started! Focus mode activated.');
    }

    function pauseSessionTimer() {
        clearInterval(sessionTimer);
        sessionRunning = false;
        showNotification('â¸ï¸ Study session paused.');
    }

    function endStudySession() {
        clearInterval(sessionTimer);
        sessionRunning = false;
        closeModal('studySessionModal');
        showNotification('ðŸ Study session ended. Great work!');
    }

    function updateSessionTimer() {
        const minutes = Math.floor(sessionSeconds / 60);
        const seconds = sessionSeconds % 60;
        document.getElementById('sessionTimer').textContent =
            `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;

        // Update progress bar
        const totalSeconds = 25 * 60;
        const progress = ((totalSeconds - sessionSeconds) / totalSeconds) * 100;
        document.getElementById('sessionProgress').style.width = `${progress}%`;
    }

    // Focus Timer Functions - FULLY WORKING
    let timerInterval;
    let timerSeconds = 25 * 60;

    function startTimer() {
        if (timerInterval) return;

        timerInterval = setInterval(() => {
            timerSeconds--;
            updateTimerDisplay();

            if (timerSeconds <= 0) {
                clearInterval(timerInterval);
                showNotification('ðŸŽ‰ Timer completed! Take a break.');
                document.getElementById('timerDisplay').classList.add('text-success');
            }
        }, 1000);

        showNotification('â° Focus timer started! ðŸŽ¯');
    }

    function stopTimer() {
        clearInterval(timerInterval);
        timerInterval = null;
        showNotification('â¸ï¸ Timer stopped.');
    }

    function resetTimer() {
        clearInterval(timerInterval);
        timerInterval = null;
        timerSeconds = 25 * 60;
        updateTimerDisplay();
        document.getElementById('timerDisplay').classList.remove('text-success');
        showNotification('ðŸ”„ Timer reset to 25:00');
    }

    function updateTimerDisplay() {
        const minutes = Math.floor(timerSeconds / 60);
        const seconds = timerSeconds % 60;
        document.getElementById('timerDisplay').textContent =
            `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
    }
    // ==================== REAL AI INTEGRATION ====================

    // AI Provider Configuration
    const AI_CONFIG = {
        // Choose your preferred AI provider (uncomment one)
        provider: 'backend', // 'gemini', 'openai', 'huggingface', or 'mock'
    }
    // AI Tutor Memory System
    const aiMemory = {
        conversationHistory: [],
        context: {
            userLevel: 'intermediate',
            learningStyle: 'visual',
            currentTopics: ['Web Development', 'Machine Learning'],
            previousQuestions: []
        },
        maxHistory: 10
    };

    // Fix for missing function
    function useEnhancedMockAI() {
        console.log("Using enhanced mock AI");
        return true;
    }

    // Initialize AI Tutor
    async function initializeAITutor() {
        showNotification('ðŸ¤– AI Tutor initializing...');

        try {
            // Check API connectivity
            const isConnected = await checkAIConnectivity();

            if (isConnected) {
                document.querySelector('#ai-tutor .card-title').innerHTML +=
                    ' <span class="badge bg-success">Live AI</span>';
                showNotification('âœ… Real AI Tutor connected successfully!');
            } else {
                showNotification('âš ï¸ Using enhanced mock AI');
                // Initialize mock AI
            }
        } catch (error) {
            console.error('AI initialization error:', error);
            // Fallback to mock AI
        }
    }

    // Check AI API Connectivity
    async function checkAIConnectivity() {
        const provider = AI_CONFIG.provider;

        // Check if API key is configured
        if (!AI_CONFIG[provider]?.apiKey || AI_CONFIG[provider].apiKey.includes('YourAPIKey')) {
            return false;
        }

        try {
            // Simple test query
            const testResult = await callRealAI('Hello');
            return testResult && testResult.length > 0;
        } catch (error) {
            console.warn(`AI API (${provider}) not available:`, error.message);
            return false;
        }
    }

    // Main AI Function with Real AI Integration
    async function askAI() {
        const questionInput = document.getElementById('aiQuestion');
        const question = questionInput.value.trim();

        if (!question) return;

        const chatContainer = document.getElementById('aiChat');

        // Add user message
        const userMessage = document.createElement('div');
        userMessage.className = 'ai-message user-message';
        userMessage.innerHTML = `<strong>You:</strong> ${question}`;
        chatContainer.appendChild(userMessage);

        // Clear input
        questionInput.value = '';

        // Show thinking indicator
        const thinkingMessage = document.createElement('div');
        thinkingMessage.className = 'ai-message bot-message';
        thinkingMessage.innerHTML = `
        <strong>AI Tutor:</strong>
        <span class="loader"></span>
        <small class="text-muted">Analyzing your question...</small>
    `;
        chatContainer.appendChild(thinkingMessage);
        chatContainer.scrollTop = chatContainer.scrollHeight;

        // Add to memory
        aiMemory.conversationHistory.push({
            role: 'user',
            content: question,
            timestamp: new Date().toISOString()
        });

        // Trim history if needed
        if (aiMemory.conversationHistory.length > aiMemory.maxHistory) {
            aiMemory.conversationHistory = aiMemory.conversationHistory.slice(-aiMemory.maxHistory);
        }

        try {
            let aiResponse;

            // Try real AI first (simplified check)
            const provider = AI_CONFIG.provider;
            if (provider === 'gemini' && AI_CONFIG.gemini.apiKey && !AI_CONFIG.gemini.apiKey.includes('YourAPIKey')) {
                aiResponse = await callGeminiAI(question);
            } else {
                // Fallback to enhanced mock AI
                aiResponse = await callEnhancedMockAI(question);
            }

            // Remove thinking message
            thinkingMessage.remove();

            // Add AI response
            const botMessage = document.createElement('div');
            botMessage.className = 'ai-message bot-message';
            botMessage.innerHTML = `<strong>AI Tutor:</strong> ${formatAIResponse(aiResponse)}`;
            chatContainer.appendChild(botMessage);

            // Add to memory
            aiMemory.conversationHistory.push({
                role: 'assistant',
                content: aiResponse,
                timestamp: new Date().toISOString()
            });

            // Update context
            updateLearningContext(question, aiResponse);

            // Show success
            showNotification('âœ… AI Tutor provided a detailed answer!');

            // Auto-scroll
            chatContainer.scrollTop = chatContainer.scrollHeight;

        } catch (error) {
            console.error('AI Error:', error);

            // Remove thinking message
            thinkingMessage.remove();

            // Show error response
            const errorMessage = document.createElement('div');
            errorMessage.className = 'ai-message bot-message';
            errorMessage.innerHTML = `
            <strong>AI Tutor:</strong>
            <span class="text-danger">I'm having trouble connecting. Here's what I can tell you:</span><br>
            ${getFallbackResponse(question)}
        `;
            chatContainer.appendChild(errorMessage);

            showNotification('âš ï¸ Using fallback AI response');
        }
    }

    // Call Real AI API (Google Gemini)
    async function callRealAI(question) {
        const provider = AI_CONFIG.provider;

        switch (provider) {
            case 'gemini':
                return await callGeminiAI(question);
            case 'openai':
                return await callOpenAI(question);
            case 'huggingface':
                return await callHuggingFaceAI(question);
            default:
                return await callEnhancedMockAI(question);
        }
    }

    // Google Gemini AI Integration (SIMPLIFIED VERSION)
    async function callGeminiAI(question) {
        try {
            const apiKey = AI_CONFIG.gemini.apiKey;
            const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=${apiKey}`;

            console.log('Calling Gemini API with key:', apiKey.substring(0, 10) + '...');

            const response = await fetch(url, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    contents: [{
                        parts: [{
                            text: `You are an AI study tutor. Help the student with this question: ${question}.
                        Provide detailed, educational, and helpful response. Include examples if relevant.`
                        }]
                    }],
                    generationConfig: {
                        temperature: 0.7,
                        maxOutputTokens: 800,
                    }
                })
            });

            if (!response.ok) {
                const errorText = await response.text();
                console.error('Gemini API error response:', errorText);
                throw new Error(`Gemini API error: ${response.status} - ${errorText}`);
            }

            const data = await response.json();

            if (data.candidates && data.candidates[0] && data.candidates[0].content) {
                return data.candidates[0].content.parts[0].text;
            } else {
                throw new Error('Unexpected response format from Gemini API');
            }

        } catch (error) {
            console.error('Gemini API Error:', error);
            // Fallback to mock AI
            return await callEnhancedMockAI(question);
        }
    }

    // OpenAI ChatGPT Integration
    async function callOpenAI(question) {
        try {
            const response = await fetch(AI_CONFIG.openai.url, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${AI_CONFIG.openai.apiKey}`
                },
                body: JSON.stringify({
                    model: AI_CONFIG.openai.model,
                    messages: [
                        {
                            role: "system",
                            content: `You are an AI study tutor. Be helpful, detailed, and educational.`
                        },
                        {
                            role: "user",
                            content: question
                        }
                    ],
                    temperature: 0.7,
                    max_tokens: 500
                })
            });

            if (!response.ok) {
                throw new Error(`OpenAI API error: ${response.status}`);
            }

            const data = await response.json();
            return data.choices[0].message.content;

        } catch (error) {
            console.error('OpenAI API Error:', error);
            throw error;
        }
    }

    // Hugging Face Integration
    async function callHuggingFaceAI(question) {
        try {
            const response = await fetch(AI_CONFIG.huggingface.url, {
                method: 'POST',
                headers: {
                    'Authorization': `Bearer ${AI_CONFIG.huggingface.apiKey}`,
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    inputs: `As an AI tutor, answer this study question: ${question}`,
                    parameters: {
                        max_length: 200,
                        temperature: 0.7
                    }
                })
            });

            if (!response.ok) {
                throw new Error(`Hugging Face API error: ${response.status}`);
            }

            const data = await response.json();
            return Array.isArray(data) ? data[0].generated_text : data.generated_text;

        } catch (error) {
            console.error('Hugging Face API Error:', error);
            throw error;
        }
    }

    // Enhanced Mock AI (Fallback with better responses)
    async function callEnhancedMockAI(question) {
        // Simulate API delay
        await new Promise(resolve => setTimeout(resolve, 800 + Math.random() * 800));

        // Analyze question for better responses
        const questionAnalysis = analyzeQuestion(question);

        // Generate contextual response
        const responses = {
            programming: [
                `For **${question}**, here's a detailed explanation:\n\n` +
                `**Concept:** This is an important programming concept that forms the foundation of many applications.\n` +
                `**Example Code:** \`\`\`javascript\n// Practical example\nfunction demonstrate() {\n  console.log("Understanding ${questionAnalysis.topic || 'programming'} concepts");\n}\`\`\`\n` +
                `**Best Practice:** Always write clean, well-documented code and follow industry standards.`,

                `Great question about **${questionAnalysis.topic || 'programming'}**! Let me explain step by step:\n\n` +
                `1. **Basic Concept:** Start with the fundamental principles\n` +
                `2. **Implementation:** How to apply it in real projects\n` +
                `3. **Common Pitfalls:** Things developers often get wrong\n` +
                `4. **Advanced Usage:** Tips for experienced programmers\n\n` +
                `Would you like me to elaborate on any specific aspect?`
            ],

            theory: [
                `Regarding **${question}**, here's the theoretical foundation:\n\n` +
                `**Key Principles:** \nâ€¢ Fundamental principle 1\nâ€¢ Core concept 2\nâ€¢ Important theory 3\n\n` +
                `**Real-World Applications:** Where this theory is practically used\n` +
                `**Related Concepts:** Connected ideas you should explore next`,

                `That's an excellent theoretical question! Let me break it down:\n\n` +
                `**Definition:** Clear explanation of what "${question}" means\n` +
                `**Historical Context:** How this concept evolved over time\n` +
                `**Importance:** Why it matters in modern technology\n` +
                `**Practical Examples:** How it's applied in real scenarios`
            ],

            general: [
                `I'd be happy to help with **${question}**! As your AI study tutor, here's my advice:\n\n` +
                `â€¢ **Study Strategy:** Break complex topics into smaller, manageable parts\n` +
                `â€¢ **Learning Resources:** Check our resources section for detailed materials\n` +
                `â€¢ **Practice Approach:** Regular hands-on exercises are crucial\n` +
                `â€¢ **Revision Technique:** Systematic review helps long-term retention`,

                `Thanks for asking about **${question}**! This is crucial for your learning journey. Here's a structured approach:\n\n` +
                `**Step-by-Step Learning Path:**\n1. Start with basic concepts\n2. Practice with simple examples\n3. Build small projects\n4. Seek feedback and iterate\n5. Teach others to reinforce learning\n\n` +
                `Need more specific guidance? Feel free to ask follow-up questions!`
            ]
        };

        const category = questionAnalysis.category || 'general';
        const categoryResponses = responses[category] || responses.general;

        return categoryResponses[Math.floor(Math.random() * categoryResponses.length)];
    }

    // Analyze question for better context
    function analyzeQuestion(question) {
        const lowerQuestion = question.toLowerCase();

        const analysis = {
            category: 'general',
            topic: null,
            complexity: 'medium'
        };

        // Detect category
        if (lowerQuestion.includes('code') || lowerQuestion.includes('program') ||
            lowerQuestion.includes('javascript') || lowerQuestion.includes('python') ||
            lowerQuestion.includes('html') || lowerQuestion.includes('css') ||
            lowerQuestion.includes('function') || lowerQuestion.includes('variable') ||
            lowerQuestion.includes('api') || lowerQuestion.includes('database')) {
            analysis.category = 'programming';
        } else if (lowerQuestion.includes('theory') || lowerQuestion.includes('concept') ||
            lowerQuestion.includes('explain') || lowerQuestion.includes('define') ||
            lowerQuestion.includes('what is') || lowerQuestion.includes('how does')) {
            analysis.category = 'theory';
        }

        // Detect topic
        const topics = {
            'web development': ['html', 'css', 'javascript', 'react', 'node', 'frontend', 'backend'],
            'machine learning': ['ml', 'ai', 'neural', 'model', 'training', 'dataset'],
            'databases': ['sql', 'database', 'query', 'mongodb', 'mysql'],
            'algorithms': ['algorithm', 'sort', 'search', 'complexity', 'data structure']
        };

        for (const [topic, keywords] of Object.entries(topics)) {
            if (keywords.some(keyword => lowerQuestion.includes(keyword))) {
                analysis.topic = topic;
                break;
            }
        }

        // Detect complexity
        const wordCount = question.split(' ').length;
        if (wordCount > 15 || lowerQuestion.includes('advanced') || lowerQuestion.includes('complex')) {
            analysis.complexity = 'high';
        } else if (wordCount < 5) {
            analysis.complexity = 'low';
        }

        return analysis;
    }

    // Build learning context
    function buildLearningContext(question) {
        const analysis = analyzeQuestion(question);

        let context = `The student is asking about ${analysis.topic || 'a study topic'}. `;
        context += `Question complexity: ${analysis.complexity}. `;

        // Add recent topics if available
        if (aiMemory.context.previousQuestions.length > 0) {
            context += `Recently asked about: ${aiMemory.context.previousQuestions.slice(-3).join(', ')}. `;
        }

        // Add study suggestions
        if (analysis.category === 'programming') {
            context += `Suggest practical coding examples and best practices.`;
        } else if (analysis.category === 'theory') {
            context += `Provide clear definitions and real-world applications.`;
        } else {
            context += `Offer structured guidance and study tips.`;
        }

        return context;
    }

    // Update learning context
    function updateLearningContext(question, response) {
        // Add to previous questions
        aiMemory.context.previousQuestions.push(question.substring(0, 50) + '...');
        if (aiMemory.context.previousQuestions.length > 5) {
            aiMemory.context.previousQuestions.shift();
        }

        // Detect learning level from question
        const analysis = analyzeQuestion(question);
        if (analysis.complexity === 'high' && aiMemory.context.userLevel === 'beginner') {
            aiMemory.context.userLevel = 'intermediate';
        }

        // Detect topic from response
        const topics = ['Web Development', 'Machine Learning', 'Databases', 'Algorithms'];
        topics.forEach(topic => {
            if (response.toLowerCase().includes(topic.toLowerCase()) &&
                !aiMemory.context.currentTopics.includes(topic)) {
                aiMemory.context.currentTopics.push(topic);
            }
        });
    }

    // Format AI response for better display
    function formatAIResponse(response) {
        if (!response) return "No response received from AI.";

        // Convert markdown-like formatting to HTML
        let formatted = response
            .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
            .replace(/\*(.*?)\*/g, '<em>$1</em>')
            .replace(/\n\n/g, '</p><p>')
            .replace(/\n/g, '<br>')
            .replace(/```(\w+)?\n([\s\S]*?)\n```/g, '<pre><code class="language-$1">$2</code></pre>')
            .replace(/`([^`]+)`/g, '<code>$1</code>');

        // Add paragraph tags
        formatted = `<p>${formatted}</p>`;

        return formatted;
    }

    // Get fallback response
    function getFallbackResponse(question) {
        const fallbacks = [
            `Based on common study materials, <strong>"${question}"</strong> relates to important concepts that you should focus on. ` +
            `I recommend checking the course materials and practicing related exercises.`,

            `For <strong>"${question}"</strong>, many students find it helpful to:<br>
        1. Review basic concepts first<br>
        2. Look at practical examples<br>
        3. Try hands-on practice<br>
        4. Ask for specific help when stuck`,

            `While I can't access real-time AI right now, I can tell you that <strong>"${question}"</strong> is a great question! ` +
            `It shows you're thinking deeply about your studies. Check our resources section for detailed materials.`
        ];

        return fallbacks[Math.floor(Math.random() * fallbacks.length)];
    }

    // Quick question function
    function quickQuestion(question) {
        document.getElementById('aiQuestion').value = question;
        askAI();
    }

    // Handle Enter key
    function handleKeyPress(event) {
        if (event.key === 'Enter' && !event.shiftKey) {
            event.preventDefault();
            askAI();
        }
    }

    // AI Tutor Features Menu
    function showAIFeatures() {
        const aiSidebar = document.querySelector('#ai-tutor .col-md-4');
        if (aiSidebar && !document.querySelector('.ai-features-menu')) {
            const features = `
        <div class="card mb-3 ai-features-menu">
            <div class="card-body">
                <h6><i class="fas fa-cogs text-primary"></i> AI Features</h6>
                <button class="btn btn-sm btn-outline-primary w-100 mb-2" onclick="summarizeConversation()">
                    <i class="fas fa-file-contract"></i> Summarize Chat
                </button>
                <button class="btn btn-sm btn-outline-primary w-100 mb-2" onclick="generateStudyPlan()">
                    <i class="fas fa-calendar-check"></i> Create Study Plan
                </button>
                <button class="btn btn-sm btn-outline-primary w-100 mb-2" onclick="explainCode()">
                    <i class="fas fa-code"></i> Explain Code
                </button>
                <button class="btn btn-sm btn-outline-success w-100" onclick="startVoiceInput()">
                    <i class="fas fa-microphone"></i> Voice Input
                </button>
            </div>
        </div>
    `;
            aiSidebar.innerHTML += features;
        }
    }

    // Summarize conversation
    async function summarizeConversation() {
        if (aiMemory.conversationHistory.length === 0) {
            showNotification('No conversation to summarize');
            return;
        }

        const summaryPrompt = `Summarize this study conversation in 3 key points:\n\n` +
            aiMemory.conversationHistory.map(msg => `${msg.role}: ${msg.content}`).join('\n');

        document.getElementById('aiQuestion').value = summaryPrompt;
        askAI();
    }

    // Generate study plan
    function generateStudyPlan() {
        const planPrompt = `Create a 7-day study plan for ${aiMemory.context.currentTopics[0] || 'web development'} ` +
            `for a ${aiMemory.context.userLevel} level student with ${aiMemory.context.learningStyle} learning style. ` +
            `Include daily topics, exercises, and goals.`;

        document.getElementById('aiQuestion').value = planPrompt;
        askAI();
    }

    // Explain code
    function explainCode() {
        const codePrompt = `Explain this code snippet step by step:\n\n` +
            `[Paste your code here]\n\n` +
            `Focus on: 1) What it does, 2) How it works, 3) Key concepts, 4) Best practices`;

        document.getElementById('aiQuestion').value = codePrompt;
        showNotification('ðŸ“ Paste your code in the input box and ask!');
    }

    // Clear chat history
    function clearAIChat() {
        const chatContainer = document.getElementById('aiChat');
        chatContainer.innerHTML = `
        <div class="ai-message bot-message">
            <strong>AI Tutor:</strong> Hello! I'm your AI study assistant. Ask me anything about your courses, assignments, or concepts you're struggling with!
        </div>
    `;

        // Reset memory
        aiMemory.conversationHistory = [];
        showNotification('ðŸ—‘ï¸ Chat history cleared');
    }

    // Export conversation
    function exportConversation() {
        if (aiMemory.conversationHistory.length === 0) {
            showNotification('No conversation to export');
            return;
        }

        const conversation = aiMemory.conversationHistory.map(msg =>
            `${msg.role.toUpperCase()}: ${msg.content}\nTimestamp: ${new Date(msg.timestamp).toLocaleString()}`
        ).join('\n\n');

        const blob = new Blob([conversation], { type: 'text/plain' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `study-conversation-${new Date().toISOString().split('T')[0]}.txt`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);

        showNotification('ðŸ’¾ Conversation exported successfully!');
    }



    // Voice input feature
    function startVoiceInput() {
        if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            const recognition = new SpeechRecognition();

            recognition.continuous = false;
            recognition.interimResults = false;
            recognition.lang = 'en-US';

            recognition.onresult = function(event) {
                const transcript = event.results[0][0].transcript;
                document.getElementById('aiQuestion').value = transcript;
                showNotification('ðŸŽ¤ Voice input captured! Press Enter or click Ask.');
            };

            recognition.onerror = function(event) {
                console.error('Speech recognition error', event.error);
                showNotification('ðŸŽ¤ Voice input failed. Please type instead.');
            };

            recognition.start();
            showNotification('ðŸŽ¤ Listening... Speak your question now.');
        } else {
            showNotification('ðŸŽ¤ Voice input not supported in this browser.');
        }
    }

    // Initialize AI when page loads
    document.addEventListener('DOMContentLoaded', function() {
        initializeAITutor();

        // Small delay to ensure DOM is ready
        setTimeout(showAIFeatures, 500);

        // Add AI controls to chat interface
        const aiChatContainer = document.querySelector('#aiChat')?.parentElement;
        if (aiChatContainer && !aiChatContainer.querySelector('.ai-controls')) {
            const aiControls = `
            <div class="d-flex justify-content-between mt-2 ai-controls">
                <button class="btn btn-sm btn-outline-secondary" onclick="clearAIChat()">
                    <i class="fas fa-trash"></i> Clear
                </button>
                <button class="btn btn-sm btn-outline-secondary" onclick="exportConversation()">
                    <i class="fas fa-download"></i> Export
                </button>
                <button class="btn btn-sm btn-outline-info" onclick="startVoiceInput()">
                    <i class="fas fa-microphone"></i> Voice
                </button>
            </div>
        `;
            aiChatContainer.innerHTML += aiControls;
        }
    });

    // Theme Toggle
    function toggleTheme() {
        const body = document.body;
        const themeIcon = document.getElementById('themeIcon');

        if (body.classList.contains('dark-theme')) {
            body.classList.remove('dark-theme');
            themeIcon.classList.remove('fa-sun');
            themeIcon.classList.add('fa-moon');
            showNotification('ðŸŒž Switched to light theme');
        } else {
            body.classList.add('dark-theme');
            themeIcon.classList.remove('fa-moon');
            themeIcon.classList.add('fa-sun');
            showNotification('ðŸŒ™ Switched to dark theme');
        }
    }

    // Mobile Menu Toggle
    document.getElementById('menuToggle').addEventListener('click', function() {
        document.getElementById('sidebar').classList.toggle('active');
    });

    // Close modal when clicking outside
    document.querySelectorAll('.modal-overlay').forEach(modal => {
        modal.addEventListener('click', function(e) {
            if (e.target === this) {
                this.classList.remove('active');
            }
        });
    });

    // NEW FEATURES IMPLEMENTATION

    // Study Goals
    function toggleGoal(element) {
        element.classList.toggle('completed');
        if (element.classList.contains('completed')) {
            showNotification('ðŸŽ¯ Goal completed! Great job!');
        }
    }

    function addNewGoal() {
        const goalText = prompt('Enter your new study goal:');
        if (goalText) {
            const goalsContainer = document.querySelector('.card-body .mt-3');
            const newGoal = document.createElement('div');
            newGoal.className = 'goal-progress';
            newGoal.innerHTML = `
                <div class="goal-check" onclick="toggleGoal(this)"><i class="fas fa-check"></i></div>
                <div>${goalText}</div>
            `;
            goalsContainer.appendChild(newGoal);
            showNotification('ðŸŽ¯ New study goal added!');
        }
    }

    // ================= POMODORO TIMER =================

    let pomodoroInterval = null;
    let pomodoroSeconds = 25 * 60;
    let currentMode = "pomodoro";

    // ---------------- AUDIO ----------------
    function playAlarm() {
        const alarm = document.getElementById("alarmSound");
        if (!alarm) return;

        alarm.currentTime = 0;
        alarm.play().catch(err => {
            console.log("Audio blocked by browser:", err);
        });
    }

    // ---------------- MODE SET ----------------
    function setPomodoroTime(minutes, event) {
        stopAlarm();

        // active button
        document.querySelectorAll(".pomodoro-btn").forEach(btn => {
            btn.classList.remove("active");
        });
        if (event) event.target.classList.add("active");

        if (minutes === 25) {
            currentMode = "pomodoro";
        } else if (minutes === 5) {
            currentMode = "shortBreak";
        } else {
            currentMode = "longBreak";
        }

        pomodoroSeconds = minutes * 60;
        updatePomodoroDisplay();

        showNotification(
            `â° ${minutes}-minute ${currentMode === "pomodoro" ? "focus session" : "break"} set`
        );
    }
    //PomodoroTimer
    // ---------------- START ----------------
    function startPomodoroTimer() {
        if (pomodoroInterval) return;

        pomodoroInterval = setInterval(() => {
            pomodoroSeconds--;
            updatePomodoroDisplay();

            if (pomodoroSeconds <= 0) {
                clearInterval(pomodoroInterval);
                pomodoroInterval = null;

                playAlarm(); // ðŸ”” ALARM HERE

                if (currentMode === "pomodoro") {
                    showNotification("ðŸŽ‰ Focus session completed! Time for a break.");
                } else {
                    showNotification("ðŸ”„ Break over! Ready for another focus session?");
                }
            }
        }, 1000);

        showNotification(
            `â° ${currentMode === "pomodoro" ? "Focus" : "Break"} timer started!`
        );
    }
    function stopAlarm() {
        const alarm = document.getElementById("alarmSound");
        if (!alarm) return;

        alarm.pause();        // sound stop
        alarm.currentTime = 0; // reset to start
    }


    // ---------------- STOP ----------------
    function stopPomodoroTimer() {
        clearInterval(pomodoroInterval);
        pomodoroInterval = null;
        stopAlarm();
        showNotification("â¸ï¸ Timer stopped.");
    }

    // ---------------- RESET ----------------
    function resetPomodoroTimer() {
        clearInterval(pomodoroInterval);
        pomodoroInterval = null;
        stopAlarm();

        if (currentMode === "pomodoro") {
            pomodoroSeconds = 25 * 60;
        } else if (currentMode === "shortBreak") {
            pomodoroSeconds = 5 * 60;
        } else {
            pomodoroSeconds = 15 * 60;
        }

        updatePomodoroDisplay();
        showNotification("ðŸ”„ Timer reset!");
    }

    // ---------------- DISPLAY ----------------
    function updatePomodoroDisplay() {
        const minutes = Math.floor(pomodoroSeconds / 60);
        const seconds = pomodoroSeconds % 60;

        document.getElementById("pomodoroDisplay").textContent =
            `${minutes.toString().padStart(2, "0")}:${seconds
                .toString()
                .padStart(2, "0")}`;
    }
    // flash card

    /**
     * FLASHCARD APP - COMPLETE LOGIC
     */

// 1. GLOBAL SETTINGS & STATE
// localStorage se userId lega, agar nahi mili to default 1 use karega
    let userId = localStorage.getItem("activeUser") || 1;
    let currentCards = [];      // API se aaye hue saare cards yahan store honge
    let currentIndex = 0;       // Practice mode mein kaunsa card dikh raha hai
    let practiceRandom = false; // Random mode on/off

    // 2. INITIALIZATION
    // Jab page load hoga tab data fetch hoga
    document.addEventListener("DOMContentLoaded", loadFlashcards);

    // 3. API DATA HANDLING (CRUD)
    function loadFlashcards() {
        fetch(`/api/flashcards/${userId}`)
            .then(res => res.json())
            .then(data => {
                currentCards = data;
                renderAllFlashcards(); // Neeche ki list update karega

                // Practice area mein pehla card dikhayega
                if (currentCards.length > 0) {
                    updatePracticeCard(0);
                } else {
                    setEmptyState();
                }
            })
            .catch(err => console.error("Error fetching cards:", err));
    }

    function createFlashcard() {
        const front = document.getElementById("cardFront").value;
        const back = document.getElementById("cardBack").value;

        if (!front || !back) {
            alert("Please enter both question and answer.");
            return;
        }

        fetch("/api/flashcards", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
                question: front,
                answer: back,
                userId: userId
            })
        })
            .then(res => res.json())
            .then(() => {
                loadFlashcards(); // List refresh karein
                document.getElementById("cardFront").value = "";
                document.getElementById("cardBack").value = "";
            });
    }

    function deleteFlashcard(id) {
        if (!confirm("Are you sure you want to delete this card?")) return;

        fetch(`/api/flashcards/${id}`, { method: "DELETE" })
            .then(() => loadFlashcards());
    }

    // 4. UI RENDERING (LIST VIEW)
    function renderAllFlashcards() {
        let container = document.getElementById("flashcardsContainer");
        if (!container) return;

        container.innerHTML = "";
        currentCards.forEach(card => {
            container.innerHTML += `
        <div class="border p-2 mb-2 d-flex justify-content-between align-items-center bg-dark text-white rounded">
            <div>
                <b>Q: ${card.question}</b>
                <p class="mb-0 text-secondary">A: ${card.answer}</p>
            </div>
            <button onclick="deleteFlashcard(${card.id})" class="btn btn-sm btn-danger">
                Delete
            </button>
        </div>`;
        });
    }

    // 5. PRACTICE MODE LOGIC (THE PURPLE CARD)
    function updatePracticeCard(index) {
        if (currentCards.length === 0) return;

        const cardInner = document.querySelector('.flashcard-inner');

        // Naya card aane se pehle flip reset karein
        if (cardInner) cardInner.classList.remove('is-flipped');

        // Content change (thoda delay taaki animation smooth lage)
        setTimeout(() => {
            const frontText = document.getElementById("practiceFront");
            const backText = document.getElementById("practiceBack");

            if (frontText) frontText.innerText = currentCards[index].question;
            if (backText) backText.innerText = currentCards[index].answer;

            currentIndex = index;
        }, 150);
    }

    function nextCard() {
        if (currentCards.length === 0) return;

        if (practiceRandom) {
            let randomIndex = Math.floor(Math.random() * currentCards.length);
            updatePracticeCard(randomIndex);
        } else {
            currentIndex = (currentIndex + 1) % currentCards.length;
            updatePracticeCard(currentIndex);
        }
    }

    function prevCard() {
        if (currentCards.length === 0) return;
        currentIndex = (currentIndex - 1 + currentCards.length) % currentCards.length;
        updatePracticeCard(currentIndex);
    }

    // 6. ANIMATION & TOGGLES
    function flipCard() {
        const cardInner = document.querySelector('.flashcard-inner');
        if (cardInner) {
            cardInner.classList.toggle('is-flipped');
        }
    }

    function toggleRandomPractice() {
        practiceRandom = !practiceRandom;
        const statusText = practiceRandom ? "ðŸŽ² Random mode ON" : "âž¡ï¸ Sequential mode ON";

        // Agar aapke paas notification system hai to wahan dikhayein, warna alert
        if (typeof showNotification === "function") {
            showNotification(statusText);
        } else {
            alert(statusText);
        }
    }

    function clearAllFlashcards() {
        if (!confirm("Are you sure you want to delete all flashcards?")) return;

        // Note: Yahan server-side API call (DELETE all) honi chahiye
        // For UI purposes:
        currentCards = [];
        renderAllFlashcards();
        setEmptyState();
    }

    function setEmptyState() {
        const frontText = document.getElementById("practiceFront");
        if (frontText) frontText.innerText = "No cards available. Add some below!";
    }
    /**************** NOTES (SPRING BOOT + DB) ****************/

    /**************** NOTES (SPRING BOOT + DB) ****************/

        // 1. Pehle ensure karein ki userId storage mein hai
// Agar login ke baad set nahi kiya hai, to test ke liye '1' uthayega
    let activeUserId = localStorage.getItem("activeUser") || 1;

    let notes = []; // Local cache

    // ------------------ CREATE NOTE â†’ DB ------------------
    function createNote() {
        const title = document.getElementById("noteTitle").value.trim();
        const content = document.getElementById("noteContent").value.trim();

        if (!title || !content) {
            showNotification("âš ï¸ Fill title & content");
            return;
        }

        // Backend (NoteDto) ko ye 3 cheezein chahiye
        const notePayload = {
            title: title,
            content: content,
            userId: parseInt(activeUserId) // Logs ki error fix karne ke liye
        };

        fetch("/api/notes", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(notePayload)
        })
            .then(res => {
                if (!res.ok) throw new Error("Failed to save note. Check if User exists.");
                return res.json();
            })
            .then(newNote => {
                notes.unshift(newNote);
                renderNotes();
                document.getElementById("noteTitle").value = "";
                document.getElementById("noteContent").value = "";
                showNotification("ðŸ“ Note saved");
            })
            .catch(err => showNotification("âŒ " + err.message));
    }

    // ------------------ LOAD NOTES FROM DB (Filtered by User) ------------------
    function loadNotes() {
        // Aapke Controller ke path ke hisaab se: /api/notes/user/{userId}
        fetch(`/api/notes/user/${activeUserId}`)
            .then(res => {
                if (!res.ok) throw new Error("Failed to load notes");
                return res.json();
            })
            .then(data => {
                notes = data || [];
                renderNotes();
            })
            .catch(err => showNotification("âŒ " + err.message));
    }

    // ------------------ RENDER NOTES ------------------
    function renderNotes() {
        const container = document.getElementById("notesContainer");
        if(!container) return;

        container.innerHTML = "";

        if (notes.length === 0) {
            container.innerHTML = "<p class='text-muted'>No notes found for this user.</p>";
            return;
        }

        notes.forEach(note => {
            const div = document.createElement("div");
            div.className = "note-card shadow-sm p-3 mb-2 bg-white rounded";
            div.id = `note-${note.id}`;

            div.innerHTML = `
        <div class="note-actions text-end">
            <button class="btn btn-sm text-danger" onclick="deleteNote(${note.id})">âœ•</button>
        </div>
        <h6 class="fw-bold text-primary">${escapeHtml(note.title)}</h6>
        <p class="small text-dark">${escapeHtml(note.content)}</p>
    `;
            container.appendChild(div);
        });
    }

    // ------------------ DELETE NOTE (With userId Param) ------------------
    function deleteNote(id) {
        if(!confirm("Are you sure want to delete ?")) return;

        // Aapke logs ke mutabiq deleteNote ko userId parameter chahiye
        fetch(`/api/notes/${id}?userId=${activeUserId}`, {
            method: "DELETE"
        })
            .then(res => {
                if (!res.ok) throw new Error("Delete failed");
                notes = notes.filter(n => n.id !== id);
                renderNotes();
                showNotification("ðŸ—‘ï¸ Note deleted");
            })
            .catch(err => showNotification("âŒ " + err.message));
    }

    // ------------------ NOTIFICATION & HELPERS ------------------
    function showNotification(msg) {
        console.log(msg);
        // Agar koi toast div hai to wahan dikhayein
    }

    function escapeHtml(text) {
        const div = document.createElement("div");
        div.textContent = text;
        return div.innerHTML;
    }

    // INITIAL LOAD
    document.addEventListener("DOMContentLoaded", loadNotes);
    // Calendar System
    // Calendar System
    let currentDate = new Date();

    // DOMContentLoaded par bhi chalao, par dhyan rahe ID milni chahiye
    document.addEventListener("DOMContentLoaded", () => {
        if(document.getElementById('calendarGrid')) {
            renderCalendar();
        }
    });

    function renderCalendar() {
        const monthNames = ["January", "February", "March", "April", "May", "June",
            "July", "August", "September", "October", "November", "December"
        ];

        const monthDisplay = document.getElementById('currentMonth');
        const calendarGrid = document.getElementById('calendarGrid');

        // Safety Check: Agar IDs nahi mili toh error na aaye
        if (!monthDisplay || !calendarGrid) return;

        monthDisplay.textContent = `${monthNames[currentDate.getMonth()]} ${currentDate.getFullYear()}`;

        const firstDay = new Date(currentDate.getFullYear(), currentDate.getMonth(), 1);
        const lastDay = new Date(currentDate.getFullYear(), currentDate.getMonth() + 1, 0);

        calendarGrid.innerHTML = '';

        // 1. Day Headers
        const days = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
        days.forEach(day => {
            const dayElement = document.createElement('div');
            dayElement.className = 'calendar-day fw-bold text-primary'; // Added class for color
            dayElement.textContent = day;
            calendarGrid.appendChild(dayElement);
        });

        // 2. Empty cells
        for (let i = 0; i < firstDay.getDay(); i++) {
            const emptyElement = document.createElement('div');
            emptyElement.className = 'calendar-day empty';
            calendarGrid.appendChild(emptyElement);
        }

        // 3. Dates
        const today = new Date();
        for (let i = 1; i <= lastDay.getDate(); i++) {
            const dayElement = document.createElement('div');
            dayElement.className = 'calendar-day';
            dayElement.textContent = i;

            // Mark today
            if (i === today.getDate() &&
                currentDate.getMonth() === today.getMonth() &&
                currentDate.getFullYear() === today.getFullYear()) {
                dayElement.classList.add('active');
            }

            // Mark events
            if ([10, 15, 25].includes(i)) {
                dayElement.classList.add('has-event');
            }

            calendarGrid.appendChild(dayElement);
        }
    }

    function previousMonth() {
        currentDate.setMonth(currentDate.getMonth() - 1);
        renderCalendar();
    }

    function nextMonth() {
        currentDate.setMonth(currentDate.getMonth() + 1);
        renderCalendar();
    }
    function showSection(sectionId) {
        // Sabhi sections se 'active' class hatao
        document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));

        // Sahi section dikhao
        const target = document.getElementById(sectionId);
        if (target) {
            target.classList.add('active');

            // AGAR CALENDAR HAI TOH USE RENDER KARO
            if(sectionId === 'calendar') {
                renderCalendar();
            }
        }
    }
    // Initialize the app
    document.addEventListener('DOMContentLoaded', function() {
        showNotification('ðŸŽ‰ Welcome to StudySmart Pro! All systems ready.');
        updateTimerDisplay();
        updateSessionTimer();
        renderCalendar();

        // Add some sample notes
        notes = [
            {
                id: 1,
                title: 'Web Development Tips',
                content: 'Remember to use semantic HTML for better accessibility and SEO.',
                date: new Date().toLocaleDateString()
            },
            {
                id: 2,
                title: 'Machine Learning Concepts',
                content: 'Supervised learning uses labeled data, unsupervised finds patterns in unlabeled data.',
                date: new Date().toLocaleDateString()
            }
        ];
        renderNotes();

        // Add some sample flashcards
        flashcards = [
            {
                front: 'What is HTML?',
                back: 'HyperText Markup Language - the standard language for creating web pages'
            },
            {
                front: 'What is CSS?',
                back: 'Cascading Style Sheets - used to style and layout web pages'
            }
        ];

        // Render sample flashcards
        flashcards.forEach((card, i) => {
            const container = document.getElementById('flashcardsContainer');
            const cardElement = document.createElement('div');
            cardElement.className = 'card mb-2';
            cardElement.innerHTML = `
                <div class="card-body p-3">
                    <h6>${card.front}</h6>
                    <p class="text-muted mb-0">${card.back}</p>
                    <button class="btn btn-sm btn-danger mt-2" onclick="deleteFlashcard(${i})">
                        <i class="fas fa-trash"></i> Delete
                    </button>
                </div>
            `;
            container.appendChild(cardElement);
        });

        if (flashcards.length > 0) {
            updatePracticeCard();
        }
    });
</script>

</body>
</html>
